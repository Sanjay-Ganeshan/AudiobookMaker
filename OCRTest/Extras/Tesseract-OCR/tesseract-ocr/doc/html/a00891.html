<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tesseract: /mnt/data/src/tesseract-ocr/textord/pithsync.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tesseract
   &#160;<span id="projectnumber">3.02</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00891.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pithsync.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="a00474_source.html">blobbox.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00592_source.html">params.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00545_source.html">statistc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00588_source.html">notdll.h</a>&quot;</code><br/>
</div>
<p><a href="a00891_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00167.html">FPCUTPT</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3e20de9a4ced394798b92a2edcba2313"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00891.html#a3e20de9a4ced394798b92a2edcba2313">check_pitch_sync2</a> (BLOBNBOX_IT *blob_it, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> blob_count, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> pitch, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> pitch_error, <a class="el" href="a00318.html">STATS</a> *projection, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> projection_left, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> projection_right, float projection_scale, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> &amp;occupation_count, FPSEGPT_LIST *seg_list, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> start, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> end)</td></tr>
<tr class="memitem:a40cc2d2a65d895b7ea644c293605ffb2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00891.html#a40cc2d2a65d895b7ea644c293605ffb2">check_pitch_sync3</a> (<a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> projection_left, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> projection_right, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> zero_count, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> pitch, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> pitch_error, <a class="el" href="a00318.html">STATS</a> *projection, float projection_scale, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> &amp;occupation_count, FPSEGPT_LIST *seg_list, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> start, <a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> end)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a3e20de9a4ced394798b92a2edcba2313"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double check_pitch_sync2 </td>
          <td>(</td>
          <td class="paramtype">BLOBNBOX_IT *&#160;</td>
          <td class="paramname"><em>blob_it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>blob_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>pitch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>pitch_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00318.html">STATS</a> *&#160;</td>
          <td class="paramname"><em>projection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>projection_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>projection_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>projection_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> &amp;&#160;</td>
          <td class="paramname"><em>occupation_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FPSEGPT_LIST *&#160;</td>
          <td class="paramname"><em>seg_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00890_source.html#l00299">299</a> of file <a class="el" href="a00890_source.html">pithsync.cpp</a>.</p>
<div class="fragment"><div class="line">                          {</div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> faking;                  <span class="comment">//illegal cut pt</span></div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> mid_cut;                 <span class="comment">//cheap cut pt.</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> x;                       <span class="comment">//current coord</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> blob_index;              <span class="comment">//blob number</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> left_edge;               <span class="comment">//of word</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> right_edge;              <span class="comment">//of word</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> array_origin;            <span class="comment">//x coord of array</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> offset;                  <span class="comment">//dist to legal area</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> zero_count;              <span class="comment">//projection zero</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_left_x = 0;         <span class="comment">//for equals</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_right_x = 0;        <span class="comment">//right edge</span></div>
<div class="line">  <a class="code" href="a00347.html">TBOX</a> this_box;                  <span class="comment">//bounding box</span></div>
<div class="line">  <a class="code" href="a00347.html">TBOX</a> next_box;                  <span class="comment">//box of next blob</span></div>
<div class="line">  <a class="code" href="a00169.html">FPSEGPT</a> *segpt;                <span class="comment">//segment point</span></div>
<div class="line">  <a class="code" href="a00167.html">FPCUTPT</a> *cutpts;               <span class="comment">//array of points</span></div>
<div class="line">  <span class="keywordtype">double</span> best_cost;              <span class="comment">//best path</span></div>
<div class="line">  <span class="keywordtype">double</span> mean_sum;               <span class="comment">//computes result</span></div>
<div class="line">  <a class="code" href="a00167.html">FPCUTPT</a> *best_end;             <span class="comment">//end of best path</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_fake;               <span class="comment">//best fake level</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_count;              <span class="comment">//no of cuts</span></div>
<div class="line">  BLOBNBOX_IT this_it;           <span class="comment">//copy iterator</span></div>
<div class="line">  FPSEGPT_IT seg_it = seg_list;  <span class="comment">//output iterator</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">//      tprintf(&quot;Computing sync on word of %d blobs with pitch %d\n&quot;,</span></div>
<div class="line">  <span class="comment">//              blob_count, pitch);</span></div>
<div class="line">  <span class="comment">//      if (blob_count==8 &amp;&amp; pitch==27)</span></div>
<div class="line">  <span class="comment">//              projection-&gt;print(stdout,TRUE);</span></div>
<div class="line">  zero_count = 0;</div>
<div class="line">  <span class="keywordflow">if</span> (pitch &lt; 3)</div>
<div class="line">    pitch = 3;                   <span class="comment">//nothing ludicrous</span></div>
<div class="line">  <span class="keywordflow">if</span> ((pitch - 3) / 2 &lt; pitch_error)</div>
<div class="line">    pitch_error = (pitch - 3) / 2;</div>
<div class="line">  this_it = *blob_it;</div>
<div class="line">  this_box = <a class="code" href="a00473.html#a343c30f9e935058965b844710a2e3180">box_next</a> (&amp;this_it);<span class="comment">//get box</span></div>
<div class="line">  <span class="comment">//      left_edge=this_box.left();                                              //left of word</span></div>
<div class="line">  <span class="comment">//      right_edge=this_box.right();</span></div>
<div class="line">  <span class="comment">//      for (blob_index=1;blob_index&lt;blob_count;blob_index++)</span></div>
<div class="line">  <span class="comment">//      {</span></div>
<div class="line">  <span class="comment">//              this_box=box_next(&amp;this_it);</span></div>
<div class="line">  <span class="comment">//              if (this_box.right()&gt;right_edge)</span></div>
<div class="line">  <span class="comment">//                      right_edge=this_box.right();</span></div>
<div class="line">  <span class="comment">//      }</span></div>
<div class="line">  <span class="keywordflow">for</span> (left_edge = projection_left; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (left_edge) == 0</div>
<div class="line">    &amp;&amp; left_edge &lt; projection_right; left_edge++);</div>
<div class="line">  <span class="keywordflow">for</span> (right_edge = projection_right; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (right_edge) == 0</div>
<div class="line">    &amp;&amp; right_edge &gt; left_edge; right_edge--);</div>
<div class="line">  <a class="code" href="a00569.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a> (right_edge &gt;= left_edge);</div>
<div class="line">  <span class="keywordflow">if</span> (pitsync_linear_version &gt;= 4)</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="a00890.html#a40cc2d2a65d895b7ea644c293605ffb2">check_pitch_sync3</a> (projection_left, projection_right, zero_count,</div>
<div class="line">      pitch, pitch_error, projection,</div>
<div class="line">      projection_scale, occupation_count, seg_list,</div>
<div class="line">      start, end);</div>
<div class="line">  array_origin = left_edge - pitch;</div>
<div class="line">  cutpts = (<a class="code" href="a00167.html">FPCUTPT</a> *) <a class="code" href="a00583.html#a4c14b091498fb7866a1dd0af51a591fe">alloc_mem</a> ((right_edge - left_edge + pitch * 2 + 1)</div>
<div class="line">    * <span class="keyword">sizeof</span> (<a class="code" href="a00167.html">FPCUTPT</a>));</div>
<div class="line">  <span class="keywordflow">for</span> (x = array_origin; x &lt; left_edge; x++)</div>
<div class="line">                                 <span class="comment">//free cuts</span></div>
<div class="line">    cutpts[x - array_origin].setup (cutpts, array_origin, projection, zero_count, pitch, x, 0);</div>
<div class="line">  <span class="keywordflow">for</span> (offset = 0; offset &lt;= pitch_error; offset++, x++)</div>
<div class="line">                                 <span class="comment">//not quite free</span></div>
<div class="line">    cutpts[x - array_origin].setup (cutpts, array_origin, projection, zero_count, pitch, x, offset);</div>
<div class="line"></div>
<div class="line">  this_it = *blob_it;</div>
<div class="line">  best_cost = <a class="code" href="a00577.html#a9adcee815220ec9db98062213806ed04">MAX_FLOAT32</a>;</div>
<div class="line">  best_end = <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">  this_box = <a class="code" href="a00473.html#a343c30f9e935058965b844710a2e3180">box_next</a> (&amp;this_it);<span class="comment">//first box</span></div>
<div class="line">  next_box = <a class="code" href="a00473.html#a343c30f9e935058965b844710a2e3180">box_next</a> (&amp;this_it);<span class="comment">//second box</span></div>
<div class="line">  blob_index = 1;</div>
<div class="line">  <span class="keywordflow">while</span> (x &lt; right_edge - pitch_error) {</div>
<div class="line">    <span class="keywordflow">if</span> (x &gt; this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () + pitch_error &amp;&amp; blob_index &lt; blob_count) {</div>
<div class="line">      this_box = next_box;</div>
<div class="line">      next_box = <a class="code" href="a00473.html#a343c30f9e935058965b844710a2e3180">box_next</a> (&amp;this_it);</div>
<div class="line">      blob_index++;</div>
<div class="line">    }</div>
<div class="line">    faking = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">    mid_cut = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (x &lt;= this_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ())</div>
<div class="line">      offset = 0;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt;= this_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () + pitch_error)</div>
<div class="line">      offset = x - this_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ();</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ())</div>
<div class="line">      offset = 0;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= next_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () &amp;&amp; blob_index &lt; blob_count) {</div>
<div class="line">      offset = x - next_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ();</div>
<div class="line">      <span class="keywordflow">if</span> (this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () - x &lt; offset)</div>
<div class="line">        offset = this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () - x;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () - pitch_error)</div>
<div class="line">      offset = this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () - x;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x - this_box.<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () &gt; pitch * <a class="code" href="a00892.html#a0d941a59238ff3b7bcca1077af788d43">pitsync_joined_edge</a></div>
<div class="line">    &amp;&amp; this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () - x &gt; pitch * <a class="code" href="a00892.html#a0d941a59238ff3b7bcca1077af788d43">pitsync_joined_edge</a>) {</div>
<div class="line">      mid_cut = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">      offset = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      faking = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">      offset = projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x);</div>
<div class="line">    }</div>
<div class="line">    cutpts[x - array_origin].<a class="code" href="a00167.html#ae8b03015ca9993673024a22a8dc904e1">assign</a> (cutpts, array_origin, x,</div>
<div class="line">      faking, mid_cut, offset, projection,</div>
<div class="line">      projection_scale, zero_count, pitch,</div>
<div class="line">      pitch_error);</div>
<div class="line">    x++;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  best_fake = <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>;</div>
<div class="line">  best_cost = <a class="code" href="a00577.html#aac62d87844689a18b6f5339a89ed6e7f">MAX_INT32</a>;</div>
<div class="line">  best_count = <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>;</div>
<div class="line">  <span class="keywordflow">while</span> (x &lt; right_edge + pitch) {</div>
<div class="line">    offset = x &lt; right_edge ? right_edge - x : 0;</div>
<div class="line">    cutpts[x - array_origin].<a class="code" href="a00167.html#ae8b03015ca9993673024a22a8dc904e1">assign</a> (cutpts, array_origin, x,</div>
<div class="line">      <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, offset, projection,</div>
<div class="line">      projection_scale, zero_count, pitch,</div>
<div class="line">      pitch_error);</div>
<div class="line">    cutpts[x - array_origin].<a class="code" href="a00167.html#aad85bb77d2c329c43abd41e854183f1d">terminal</a> = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (cutpts[x - array_origin].index () +</div>
<div class="line">    cutpts[x - array_origin].fake_count &lt;= best_count + best_fake) {</div>
<div class="line">      <span class="keywordflow">if</span> (cutpts[x - array_origin].fake_count &lt; best_fake</div>
<div class="line">        || (cutpts[x - array_origin].fake_count == best_fake</div>
<div class="line">      &amp;&amp; cutpts[x - array_origin].cost_function () &lt; best_cost)) {</div>
<div class="line">        best_fake = cutpts[x - array_origin].<a class="code" href="a00167.html#a4700de0507676a547b49f7b5b0414b1b">fake_count</a>;</div>
<div class="line">        best_cost = cutpts[x - array_origin].<a class="code" href="a00167.html#a754e205021f03c913ca0aa5b277b1aac">cost_function</a> ();</div>
<div class="line">        best_left_x = x;</div>
<div class="line">        best_right_x = x;</div>
<div class="line">        best_count = cutpts[x - array_origin].<a class="code" href="a00167.html#a948343c0460bfe23f0e43c4ff3085813">index</a> ();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cutpts[x - array_origin].fake_count == best_fake</div>
<div class="line">        &amp;&amp; x == best_right_x + 1</div>
<div class="line">      &amp;&amp; cutpts[x - array_origin].cost_function () == best_cost) {</div>
<div class="line">      <span class="comment">//exactly equal</span></div>
<div class="line">        best_right_x = x;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    x++;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="a00569.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a> (best_fake &lt; <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>);</div>
<div class="line"></div>
<div class="line">  best_end = &amp;cutpts[(best_left_x + best_right_x) / 2 - array_origin];</div>
<div class="line">  <span class="keywordflow">if</span> (this_box.<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () == <a class="code" href="a00886.html#a23b8c104a388b836300c6aaf9592c66f">textord_test_x</a></div>
<div class="line">  &amp;&amp; this_box.<a class="code" href="a00347.html#adf92e9fdac1bdf11c10d1c4d1178791a">top</a> () == <a class="code" href="a00886.html#ac7548cdecc88963c89ab9d235a6c6531">textord_test_y</a>) {</div>
<div class="line">    <span class="keywordflow">for</span> (x = left_edge - pitch; x &lt; right_edge + pitch; x++) {</div>
<div class="line">      <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;x=%d, C=%g, s=%g, sq=%g, prev=%d\n&quot;</span>,</div>
<div class="line">        x, cutpts[x - array_origin].cost_function (),</div>
<div class="line">        cutpts[x - array_origin].sum (),</div>
<div class="line">        cutpts[x - array_origin].squares (),</div>
<div class="line">        cutpts[x - array_origin].previous ()-&gt;position ());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  occupation_count = -1;</div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    <span class="keywordflow">for</span> (x = best_end-&gt;<a class="code" href="a00167.html#a4bd6376f9b5ec6825df3fdb5a7db3d6c">position</a> () - pitch + pitch_error;</div>
<div class="line">      x &lt; best_end-&gt;<a class="code" href="a00167.html#a4bd6376f9b5ec6825df3fdb5a7db3d6c">position</a> () - pitch_error</div>
<div class="line">      &amp;&amp; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x) == 0; x++);</div>
<div class="line">    <span class="keywordflow">if</span> (x &lt; best_end-&gt;position () - pitch_error)</div>
<div class="line">      occupation_count++;</div>
<div class="line">                                 <span class="comment">//copy it</span></div>
<div class="line">    segpt = <span class="keyword">new</span> <a class="code" href="a00169.html">FPSEGPT</a> (best_end);</div>
<div class="line">    seg_it.add_before_then_move (segpt);</div>
<div class="line">    best_end = best_end-&gt;<a class="code" href="a00167.html#af9b9cd3fd3e437486e6020d16580fe9d">previous</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">while</span> (best_end != <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line">  seg_it.move_to_last ();</div>
<div class="line">  mean_sum = seg_it.data ()-&gt;<a class="code" href="a00167.html#aa458ef97a2dfab2d805c5c58acbc2459">sum</a> ();</div>
<div class="line">  mean_sum = mean_sum * mean_sum / best_count;</div>
<div class="line">  <span class="keywordflow">if</span> (seg_it.data ()-&gt;squares () - mean_sum &lt; 0)</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Impossible sqsum=%g, mean=%g, total=%d\n&quot;</span>,</div>
<div class="line">      seg_it.data ()-&gt;squares (), seg_it.data ()-&gt;sum (), best_count);</div>
<div class="line">  <a class="code" href="a00583.html#a9ef1862b8e026e23eef238af032858e4">free_mem</a>(cutpts);</div>
<div class="line">  <span class="comment">//      tprintf(&quot;blob_count=%d, pitch=%d, sync=%g, occ=%d\n&quot;,</span></div>
<div class="line">  <span class="comment">//              blob_count,pitch,seg_it.data()-&gt;squares()-mean_sum,</span></div>
<div class="line">  <span class="comment">//              occupation_count);</span></div>
<div class="line">  <span class="keywordflow">return</span> seg_it.data ()-&gt;squares () - mean_sum;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a40cc2d2a65d895b7ea644c293605ffb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double check_pitch_sync3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>projection_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>projection_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>zero_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>pitch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>pitch_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00318.html">STATS</a> *&#160;</td>
          <td class="paramname"><em>projection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>projection_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> &amp;&#160;</td>
          <td class="paramname"><em>occupation_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FPSEGPT_LIST *&#160;</td>
          <td class="paramname"><em>seg_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00890_source.html#l00496">496</a> of file <a class="el" href="a00890_source.html">pithsync.cpp</a>.</p>
<div class="fragment"><div class="line">                          {</div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> faking;                  <span class="comment">//illegal cut pt</span></div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> mid_cut;                 <span class="comment">//cheap cut pt.</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> left_edge;               <span class="comment">//of word</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> right_edge;              <span class="comment">//of word</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> x;                       <span class="comment">//current coord</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> array_origin;            <span class="comment">//x coord of array</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> offset;                  <span class="comment">//dist to legal area</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> projection_offset;       <span class="comment">//from scaled projection</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> prev_zero;               <span class="comment">//previous zero dist</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> next_zero;               <span class="comment">//next zero dist</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> zero_offset;             <span class="comment">//scan window</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_left_x = 0;         <span class="comment">//for equals</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_right_x = 0;        <span class="comment">//right edge</span></div>
<div class="line">  <a class="code" href="a00169.html">FPSEGPT</a> *segpt;                <span class="comment">//segment point</span></div>
<div class="line">  <a class="code" href="a00167.html">FPCUTPT</a> *cutpts;               <span class="comment">//array of points</span></div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> *mins;                   <span class="comment">//local min results</span></div>
<div class="line">  <span class="keywordtype">int</span> minindex;                  <span class="comment">//next input position</span></div>
<div class="line">  <span class="keywordtype">int</span> test_index;                <span class="comment">//index to mins</span></div>
<div class="line">  <span class="keywordtype">double</span> best_cost;              <span class="comment">//best path</span></div>
<div class="line">  <span class="keywordtype">double</span> mean_sum;               <span class="comment">//computes result</span></div>
<div class="line">  <a class="code" href="a00167.html">FPCUTPT</a> *best_end;             <span class="comment">//end of best path</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_fake;               <span class="comment">//best fake level</span></div>
<div class="line">  <a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a> best_count;              <span class="comment">//no of cuts</span></div>
<div class="line">  FPSEGPT_IT seg_it = seg_list;  <span class="comment">//output iterator</span></div>
<div class="line"></div>
<div class="line">  end = (end - start) % pitch;</div>
<div class="line">  <span class="keywordflow">if</span> (pitch &lt; 3)</div>
<div class="line">    pitch = 3;                   <span class="comment">//nothing ludicrous</span></div>
<div class="line">  <span class="keywordflow">if</span> ((pitch - 3) / 2 &lt; pitch_error)</div>
<div class="line">    pitch_error = (pitch - 3) / 2;</div>
<div class="line">                                 <span class="comment">//min dist of zero</span></div>
<div class="line">  zero_offset = (<a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>) (pitch * <a class="code" href="a00892.html#a0d941a59238ff3b7bcca1077af788d43">pitsync_joined_edge</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (left_edge = projection_left; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (left_edge) == 0</div>
<div class="line">    &amp;&amp; left_edge &lt; projection_right; left_edge++);</div>
<div class="line">  <span class="keywordflow">for</span> (right_edge = projection_right; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (right_edge) == 0</div>
<div class="line">    &amp;&amp; right_edge &gt; left_edge; right_edge--);</div>
<div class="line">  array_origin = left_edge - pitch;</div>
<div class="line">  cutpts = (<a class="code" href="a00167.html">FPCUTPT</a> *) <a class="code" href="a00583.html#a4c14b091498fb7866a1dd0af51a591fe">alloc_mem</a> ((right_edge - left_edge + pitch * 2 + 1)</div>
<div class="line">    * <span class="keyword">sizeof</span> (<a class="code" href="a00167.html">FPCUTPT</a>));</div>
<div class="line">  mins = (<a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> *) <a class="code" href="a00583.html#a4c14b091498fb7866a1dd0af51a591fe">alloc_mem</a> ((pitch_error * 2 + 1) * <span class="keyword">sizeof</span> (<a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a>));</div>
<div class="line">  <span class="keywordflow">for</span> (x = array_origin; x &lt; left_edge; x++)</div>
<div class="line">                                 <span class="comment">//free cuts</span></div>
<div class="line">    cutpts[x - array_origin].setup (cutpts, array_origin, projection, zero_count, pitch, x, 0);</div>
<div class="line">  prev_zero = left_edge - 1;</div>
<div class="line">  <span class="keywordflow">for</span> (offset = 0; offset &lt;= pitch_error; offset++, x++)</div>
<div class="line">                                 <span class="comment">//not quite free</span></div>
<div class="line">    cutpts[x - array_origin].setup (cutpts, array_origin, projection, zero_count, pitch, x, offset);</div>
<div class="line"></div>
<div class="line">  best_cost = <a class="code" href="a00577.html#a9adcee815220ec9db98062213806ed04">MAX_FLOAT32</a>;</div>
<div class="line">  best_end = <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (offset = -pitch_error, minindex = 0; offset &lt; pitch_error;</div>
<div class="line">    offset++, minindex++)</div>
<div class="line">  mins[minindex] = projection-&gt;<a class="code" href="a00318.html#ace640389c49d4af2197ed5a0b74b276d">local_min</a> (x + offset);</div>
<div class="line">  next_zero = x + zero_offset + 1;</div>
<div class="line">  <span class="keywordflow">for</span> (offset = next_zero - 1; offset &gt;= x; offset--) {</div>
<div class="line">    <span class="keywordflow">if</span> (projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (offset) &lt;= zero_count) {</div>
<div class="line">      next_zero = offset;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">while</span> (x &lt; right_edge - pitch_error) {</div>
<div class="line">    mins[minindex] = projection-&gt;<a class="code" href="a00318.html#ace640389c49d4af2197ed5a0b74b276d">local_min</a> (x + pitch_error);</div>
<div class="line">    minindex++;</div>
<div class="line">    <span class="keywordflow">if</span> (minindex &gt; pitch_error * 2)</div>
<div class="line">      minindex = 0;</div>
<div class="line">    faking = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">    mid_cut = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">    offset = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x) &lt;= zero_count) {</div>
<div class="line">      prev_zero = x;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">for</span> (offset = 1; offset &lt;= pitch_error; offset++)</div>
<div class="line">        <span class="keywordflow">if</span> (projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x + offset) &lt;= zero_count</div>
<div class="line">        || projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x - offset) &lt;= zero_count)</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (offset &gt; pitch_error) {</div>
<div class="line">      <span class="keywordflow">if</span> (x - prev_zero &gt; zero_offset &amp;&amp; next_zero - x &gt; zero_offset) {</div>
<div class="line">        <span class="keywordflow">for</span> (offset = 0; offset &lt;= pitch_error; offset++) {</div>
<div class="line">          test_index = minindex + pitch_error + offset;</div>
<div class="line">          <span class="keywordflow">if</span> (test_index &gt; pitch_error * 2)</div>
<div class="line">            test_index -= pitch_error * 2 + 1;</div>
<div class="line">          <span class="keywordflow">if</span> (mins[test_index])</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          test_index = minindex + pitch_error - offset;</div>
<div class="line">          <span class="keywordflow">if</span> (test_index &gt; pitch_error * 2)</div>
<div class="line">            test_index -= pitch_error * 2 + 1;</div>
<div class="line">          <span class="keywordflow">if</span> (mins[test_index])</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (offset &gt; pitch_error) {</div>
<div class="line">        offset = projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x);</div>
<div class="line">        faking = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> {</div>
<div class="line">        projection_offset =</div>
<div class="line">          (<a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>) (projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x) / projection_scale);</div>
<div class="line">        <span class="keywordflow">if</span> (projection_offset &gt; offset)</div>
<div class="line">          offset = projection_offset;</div>
<div class="line">        mid_cut = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((start == 0 &amp;&amp; end == 0)</div>
<div class="line">      || !<a class="code" href="a00912.html#ac49ca21c7dc420fa93fbc24dd37b56c7">textord_fast_pitch_test</a></div>
<div class="line">      || (x - projection_left - start) % pitch &lt;= end)</div>
<div class="line">      cutpts[x - array_origin].<a class="code" href="a00167.html#ae8b03015ca9993673024a22a8dc904e1">assign</a> (cutpts, array_origin, x,</div>
<div class="line">        faking, mid_cut, offset, projection,</div>
<div class="line">        projection_scale, zero_count, pitch,</div>
<div class="line">        pitch_error);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      cutpts[x - array_origin].<a class="code" href="a00167.html#a4cd1de9763c534dd1b1bfb34a71a40bf">assign_cheap</a> (cutpts, array_origin, x,</div>
<div class="line">        faking, mid_cut, offset,</div>
<div class="line">        projection, projection_scale,</div>
<div class="line">        zero_count, pitch,</div>
<div class="line">        pitch_error);</div>
<div class="line">    x++;</div>
<div class="line">    <span class="keywordflow">if</span> (next_zero &lt; x || next_zero == x + zero_offset)</div>
<div class="line">      next_zero = x + zero_offset + 1;</div>
<div class="line">    <span class="keywordflow">if</span> (projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x + zero_offset) &lt;= zero_count)</div>
<div class="line">      next_zero = x + zero_offset;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  best_fake = <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>;</div>
<div class="line">  best_cost = <a class="code" href="a00577.html#aac62d87844689a18b6f5339a89ed6e7f">MAX_INT32</a>;</div>
<div class="line">  best_count = <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>;</div>
<div class="line">  <span class="keywordflow">while</span> (x &lt; right_edge + pitch) {</div>
<div class="line">    offset = x &lt; right_edge ? right_edge - x : 0;</div>
<div class="line">    cutpts[x - array_origin].<a class="code" href="a00167.html#ae8b03015ca9993673024a22a8dc904e1">assign</a> (cutpts, array_origin, x,</div>
<div class="line">      <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, offset, projection,</div>
<div class="line">      projection_scale, zero_count, pitch,</div>
<div class="line">      pitch_error);</div>
<div class="line">    cutpts[x - array_origin].<a class="code" href="a00167.html#aad85bb77d2c329c43abd41e854183f1d">terminal</a> = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (cutpts[x - array_origin].index () +</div>
<div class="line">    cutpts[x - array_origin].fake_count &lt;= best_count + best_fake) {</div>
<div class="line">      <span class="keywordflow">if</span> (cutpts[x - array_origin].fake_count &lt; best_fake</div>
<div class="line">        || (cutpts[x - array_origin].fake_count == best_fake</div>
<div class="line">      &amp;&amp; cutpts[x - array_origin].cost_function () &lt; best_cost)) {</div>
<div class="line">        best_fake = cutpts[x - array_origin].<a class="code" href="a00167.html#a4700de0507676a547b49f7b5b0414b1b">fake_count</a>;</div>
<div class="line">        best_cost = cutpts[x - array_origin].<a class="code" href="a00167.html#a754e205021f03c913ca0aa5b277b1aac">cost_function</a> ();</div>
<div class="line">        best_left_x = x;</div>
<div class="line">        best_right_x = x;</div>
<div class="line">        best_count = cutpts[x - array_origin].<a class="code" href="a00167.html#a948343c0460bfe23f0e43c4ff3085813">index</a> ();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cutpts[x - array_origin].fake_count == best_fake</div>
<div class="line">        &amp;&amp; x == best_right_x + 1</div>
<div class="line">      &amp;&amp; cutpts[x - array_origin].cost_function () == best_cost) {</div>
<div class="line">      <span class="comment">//exactly equal</span></div>
<div class="line">        best_right_x = x;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    x++;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="a00569.html#a93a603f4063a6b9403d81caa245a583b">ASSERT_HOST</a> (best_fake &lt; <a class="code" href="a00577.html#a3905e54374e49708219791e7d59c60fb">MAX_INT16</a>);</div>
<div class="line"></div>
<div class="line">  best_end = &amp;cutpts[(best_left_x + best_right_x) / 2 - array_origin];</div>
<div class="line">  <span class="comment">//      for (x=left_edge-pitch;x&lt;right_edge+pitch;x++)</span></div>
<div class="line">  <span class="comment">//      {</span></div>
<div class="line">  <span class="comment">//              tprintf(&quot;x=%d, C=%g, s=%g, sq=%g, prev=%d\n&quot;,</span></div>
<div class="line">  <span class="comment">//                      x,cutpts[x-array_origin].cost_function(),</span></div>
<div class="line">  <span class="comment">//                      cutpts[x-array_origin].sum(),</span></div>
<div class="line">  <span class="comment">//                      cutpts[x-array_origin].squares(),</span></div>
<div class="line">  <span class="comment">//                      cutpts[x-array_origin].previous()-&gt;position());</span></div>
<div class="line">  <span class="comment">//      }</span></div>
<div class="line">  occupation_count = -1;</div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    <span class="keywordflow">for</span> (x = best_end-&gt;<a class="code" href="a00167.html#a4bd6376f9b5ec6825df3fdb5a7db3d6c">position</a> () - pitch + pitch_error;</div>
<div class="line">      x &lt; best_end-&gt;<a class="code" href="a00167.html#a4bd6376f9b5ec6825df3fdb5a7db3d6c">position</a> () - pitch_error</div>
<div class="line">      &amp;&amp; projection-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (x) == 0; x++);</div>
<div class="line">    <span class="keywordflow">if</span> (x &lt; best_end-&gt;position () - pitch_error)</div>
<div class="line">      occupation_count++;</div>
<div class="line">                                 <span class="comment">//copy it</span></div>
<div class="line">    segpt = <span class="keyword">new</span> <a class="code" href="a00169.html">FPSEGPT</a> (best_end);</div>
<div class="line">    seg_it.add_before_then_move (segpt);</div>
<div class="line">    best_end = best_end-&gt;<a class="code" href="a00167.html#af9b9cd3fd3e437486e6020d16580fe9d">previous</a> ();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">while</span> (best_end != <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line">  seg_it.move_to_last ();</div>
<div class="line">  mean_sum = seg_it.data ()-&gt;<a class="code" href="a00167.html#aa458ef97a2dfab2d805c5c58acbc2459">sum</a> ();</div>
<div class="line">  mean_sum = mean_sum * mean_sum / best_count;</div>
<div class="line">  <span class="keywordflow">if</span> (seg_it.data ()-&gt;squares () - mean_sum &lt; 0)</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Impossible sqsum=%g, mean=%g, total=%d\n&quot;</span>,</div>
<div class="line">      seg_it.data ()-&gt;squares (), seg_it.data ()-&gt;sum (), best_count);</div>
<div class="line">  <a class="code" href="a00583.html#a9ef1862b8e026e23eef238af032858e4">free_mem</a>(mins);</div>
<div class="line">  <a class="code" href="a00583.html#a9ef1862b8e026e23eef238af032858e4">free_mem</a>(cutpts);</div>
<div class="line">  <span class="keywordflow">return</span> seg_it.data ()-&gt;squares () - mean_sum;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b8d1739202f65d59e58cdec119e32197.html">mnt</a></li><li class="navelem"><a class="el" href="dir_5b13d613d053bd10e358ecb54357a5d6.html">data</a></li><li class="navelem"><a class="el" href="dir_6e8f8c7261375e16fe20bf1b1c7c3b87.html">src</a></li><li class="navelem"><a class="el" href="dir_7829ead854c076361e4bcb285111c733.html">tesseract-ocr</a></li><li class="navelem"><a class="el" href="dir_ec091aa1959eb7fc14b0c00630e6a7b8.html">textord</a></li><li class="navelem"><a class="el" href="a00891.html">pithsync.h</a></li>
    <li class="footer">Generated on Thu Nov 1 2012 20:19:56 for Tesseract by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1 </li>
  </ul>
</div>
</body>
</html>
