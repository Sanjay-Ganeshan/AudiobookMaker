<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tesseract: /mnt/data/src/tesseract-ocr/textord/oldbasel.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tesseract
   &#160;<span id="projectnumber">3.02</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00888.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">oldbasel.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="a00586_source.html">mfcpch.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00484_source.html">ccstruct.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00545_source.html">statistc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00529_source.html">quadlsq.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00489_source.html">detlinefit.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00887_source.html">makerow.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00871_source.html">drawtord.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00889_source.html">oldbasel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00911_source.html">textord.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="a00608_source.html">tprintf.h</a>&quot;</code><br/>
</div>
<p><a href="a00888_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:a00995"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00995.html">tesseract</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a77366c1bd428629dc898e188bfd182a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a></td></tr>
<tr class="memitem:a740201e7bcfb78e2fe8a8674096d13fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a740201e7bcfb78e2fe8a8674096d13fe">TURNLIMIT</a>&#160;&#160;&#160;1     /*min size for turning point */</td></tr>
<tr class="memitem:a69d365e20fc65dc84fb7426c5d20fdaf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a69d365e20fc65dc84fb7426c5d20fdaf">X_HEIGHT_FRACTION</a>&#160;&#160;&#160;0.7   /*x-height/caps height */</td></tr>
<tr class="memitem:a636b5d65e6e76c9ed9c87d72e5b743da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a636b5d65e6e76c9ed9c87d72e5b743da">DESCENDER_FRACTION</a>&#160;&#160;&#160;0.5   /*descender/x-height */</td></tr>
<tr class="memitem:adafb7e3ebb2a384efa0f5a1b40476a63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#adafb7e3ebb2a384efa0f5a1b40476a63">MIN_ASC_FRACTION</a>&#160;&#160;&#160;0.20  /*min size <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> ascenders */</td></tr>
<tr class="memitem:ab10df8c6f46b62530ddf3d39eada5cbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#ab10df8c6f46b62530ddf3d39eada5cbf">MIN_DESC_FRACTION</a>&#160;&#160;&#160;0.25  /*min size <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> descenders */</td></tr>
<tr class="memitem:ae325902750f29296b4fb7ae22ecbb3dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#ae325902750f29296b4fb7ae22ecbb3dd">MINASCRISE</a>&#160;&#160;&#160;2.0   /*min ascender/desc step */</td></tr>
<tr class="memitem:af1babcc3994c55728d10e3de8a5f01c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#af1babcc3994c55728d10e3de8a5f01c5">MAXHEIGHTVARIANCE</a>&#160;&#160;&#160;0.15  /*accepted variation in x-height */</td></tr>
<tr class="memitem:ade1da022379102bc94d127f9c6358fe7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#ade1da022379102bc94d127f9c6358fe7">MAXHEIGHT</a>&#160;&#160;&#160;300   /*max blob height */</td></tr>
<tr class="memitem:a2789b0522b4b2520ddc257d0a2ba472a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a2789b0522b4b2520ddc257d0a2ba472a">MAXOVERLAP</a>&#160;&#160;&#160;0.1   /*max 10% missed overlap */</td></tr>
<tr class="memitem:a058e03b643cfba9a6b7899b9a91f9bcb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a058e03b643cfba9a6b7899b9a91f9bcb">MAXBADRUN</a>&#160;&#160;&#160;2     /*max non best for failed */</td></tr>
<tr class="memitem:a63c525ba0f53cbbfe37cb7900e8df67d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>&#160;&#160;&#160;200   /* Num <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> buckets */</td></tr>
<tr class="memitem:a23ca4a264fba12e846d074b48bc37fc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a23ca4a264fba12e846d074b48bc37fc2">DELTAHEIGHT</a>&#160;&#160;&#160;5.0   /* Small amount <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> diff */</td></tr>
<tr class="memitem:a7cfa5dee1fc7046cb35913d0d4f7a989"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a7cfa5dee1fc7046cb35913d0d4f7a989">GOODHEIGHT</a>&#160;&#160;&#160;5</td></tr>
<tr class="memitem:a1f977147000cd8a40ccfacafea826a8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a1f977147000cd8a40ccfacafea826a8e">MAXLOOPS</a>&#160;&#160;&#160;10</td></tr>
<tr class="memitem:a6d5223c09db5f2c89d2d0cb1990cae25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>&#160;&#160;&#160;10</td></tr>
<tr class="memitem:a43c12716e71c3b49f1907bd935376e43"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a43c12716e71c3b49f1907bd935376e43">MAXPARTS</a>&#160;&#160;&#160;6</td></tr>
<tr class="memitem:a28ed3351013f0697aa3189e7cfb669fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a>&#160;&#160;&#160;23</td></tr>
<tr class="memitem:a996f7be338ccb40d1a2a5abc1ad61759"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a>(x)&#160;&#160;&#160;((x)&lt;0 ? (-(x)) : (x))</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8bbd79e9db94d47b2998e03850b18181"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a8bbd79e9db94d47b2998e03850b18181">get_blob_coords</a> (<a class="el" href="a00374.html">TO_ROW</a> *row, <a class="el" href="a00577.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a> lineheight, <a class="el" href="a00347.html">TBOX</a> *blobcoords, <a class="el" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> &amp;holed_line, int &amp;outcount)</td></tr>
<tr class="memitem:a8183cffcfbc4d5ea44607619f14b44f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a8183cffcfbc4d5ea44607619f14b44f5">make_first_baseline</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, int xcoords[], int ycoords[], <a class="el" href="a00276.html">QSPLINE</a> *spline, <a class="el" href="a00276.html">QSPLINE</a> *<a class="el" href="a00670.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, float jumplimit)</td></tr>
<tr class="memitem:a6640bd141affa5aec1d6d3ee0e724e66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a6640bd141affa5aec1d6d3ee0e724e66">make_holed_baseline</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, <a class="el" href="a00276.html">QSPLINE</a> *spline, <a class="el" href="a00276.html">QSPLINE</a> *<a class="el" href="a00670.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, float gradient)</td></tr>
<tr class="memitem:a75f15842c2f303b5343bdc22504098a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a75f15842c2f303b5343bdc22504098a0">partition_line</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, int *numparts, char partids[], int partsizes[], <a class="el" href="a00276.html">QSPLINE</a> *spline, float jumplimit, float ydiffs[])</td></tr>
<tr class="memitem:a0024caf13f4e7f27e9c6ed3161138def"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a0024caf13f4e7f27e9c6ed3161138def">merge_oldbl_parts</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, char partids[], int partsizes[], int biggestpart, float jumplimit)</td></tr>
<tr class="memitem:a8be53753ccb635852471514dcbf65b9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a8be53753ccb635852471514dcbf65b9f">get_ydiffs</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, <a class="el" href="a00276.html">QSPLINE</a> *spline, float ydiffs[])</td></tr>
<tr class="memitem:a686c8b34dade68c0dd9e68ec7206739a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a686c8b34dade68c0dd9e68ec7206739a">choose_partition</a> (register float diff, float partdiffs[], int lastpart, float jumplimit, float *drift, float *lastdelta, int *partcount)</td></tr>
<tr class="memitem:aad2034679e53c7d16b8306b773c552a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#aad2034679e53c7d16b8306b773c552a7">partition_coords</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, char partids[], int bestpart, int xcoords[], int ycoords[])</td></tr>
<tr class="memdesc:aad2034679e53c7d16b8306b773c552a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">*merge_partitions(partids,partcount,blobcount,bestpart) discards funny looking  <a href="#aad2034679e53c7d16b8306b773c552a7"></a><br/></td></tr>
<tr class="memitem:a320b77e1f7ecd371bdab9b4a0c3e10db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a320b77e1f7ecd371bdab9b4a0c3e10db">segment_spline</a> (<a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, int xcoords[], int ycoords[], int degree, int pointcount, int xstarts[])</td></tr>
<tr class="memitem:a7ebf232cd4ed4b8feb53a47b8248903f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a7ebf232cd4ed4b8feb53a47b8248903f">split_stepped_spline</a> (<a class="el" href="a00276.html">QSPLINE</a> *<a class="el" href="a00670.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, float jumplimit, int xcoords[], int xstarts[], int &amp;segments)</td></tr>
<tr class="memitem:a64dfef97655fe4ff4565ed05d7d0f53a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a64dfef97655fe4ff4565ed05d7d0f53a">insert_spline_point</a> (int xstarts[], int segment, int coord1, int coord2, int &amp;segments)</td></tr>
<tr class="memitem:a010670c118cee8bc7b8c74125084ac30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a010670c118cee8bc7b8c74125084ac30">find_lesser_parts</a> (<a class="el" href="a00374.html">TO_ROW</a> *row, <a class="el" href="a00347.html">TBOX</a> blobcoords[], int blobcount, char partids[], int partsizes[], int partcount, int bestpart)</td></tr>
<tr class="memitem:a7d9be1c4d4bb8e4df217ddd66862b8ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a7d9be1c4d4bb8e4df217ddd66862b8ee">old_first_xheight</a> (<a class="el" href="a00374.html">TO_ROW</a> *row, <a class="el" href="a00347.html">TBOX</a> blobcoords[], int initialheight, int blobcount, <a class="el" href="a00276.html">QSPLINE</a> *<a class="el" href="a00670.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, float jumplimit)</td></tr>
<tr class="memitem:a57a9e3ff2547db03b8a316f2fb25f017"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a57a9e3ff2547db03b8a316f2fb25f017">make_first_xheight</a> (<a class="el" href="a00374.html">TO_ROW</a> *row, <a class="el" href="a00347.html">TBOX</a> blobcoords[], int lineheight, int init_lineheight, int blobcount, <a class="el" href="a00276.html">QSPLINE</a> *<a class="el" href="a00670.html#a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23">baseline</a>, float jumplimit)</td></tr>
<tr class="memitem:a2f17754e45de03ca3f0e2be965f8d4f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a2f17754e45de03ca3f0e2be965f8d4f4">find_top_modes</a> (<a class="el" href="a00318.html">STATS</a> *stats, int statnum, int modelist[], int modenum)</td></tr>
<tr class="memitem:a7cfd63f215d5f9d728d795ea43eaf7af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a7cfd63f215d5f9d728d795ea43eaf7af">pick_x_height</a> (<a class="el" href="a00374.html">TO_ROW</a> *row, int modelist[], int lefts[], int rights[], <a class="el" href="a00318.html">STATS</a> *heightstat, int mode_threshold)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a160e4b5a4517db072dd572847b673c9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a160e4b5a4517db072dd572847b673c9c">textord_really_old_xheight</a> = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="memitem:a49b3afd2bc9858de5ba264e9e0ce74c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a> = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="memitem:a2522a1ae924de60d6448da45f785b4f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a2522a1ae924de60d6448da45f785b4f8">textord_debug_baselines</a> = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="memitem:a26cc69b976618e872211e3974a7df35f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a26cc69b976618e872211e3974a7df35f">textord_oldbl_paradef</a> = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td></tr>
<tr class="memitem:a65c44b7980901c6716d6af6b5457fb55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a65c44b7980901c6716d6af6b5457fb55">textord_oldbl_split_splines</a> = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td></tr>
<tr class="memitem:afbc9ce48742715129ec2659c3fcb5584"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#afbc9ce48742715129ec2659c3fcb5584">textord_oldbl_merge_parts</a> = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td></tr>
<tr class="memitem:a4ac15a4b1008410caf408f3e7d71617b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a4ac15a4b1008410caf408f3e7d71617b">oldbl_corrfix</a> = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td></tr>
<tr class="memitem:a96a1495ef629e0595833f43d1e0d8edd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a96a1495ef629e0595833f43d1e0d8edd">oldbl_xhfix</a> = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="memitem:ac37e1bbb003c40e45f6375d6451a1659"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="memitem:a9af9cfbc0c19dbe46551c127ed70e6e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a9af9cfbc0c19dbe46551c127ed70e6e4">oldbl_xhfract</a> = 0.4</td></tr>
<tr class="memitem:a74b5ea2ca513022fc65ac2d68d1179fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a74b5ea2ca513022fc65ac2d68d1179fd">oldbl_holed_losscount</a> = 10</td></tr>
<tr class="memitem:a1c777e24551f3606e42efe3bdb71d56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a1c777e24551f3606e42efe3bdb71d56c">oldbl_dot_error_size</a> = 1.26</td></tr>
<tr class="memitem:aa0ab27b57cde2ce0d3e4c7c269ae58f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#aa0ab27b57cde2ce0d3e4c7c269ae58f8">textord_oldbl_jumplimit</a> = 0.15</td></tr>
<tr class="memitem:a4b62dc4268d026719e353774ec602bec"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a4b62dc4268d026719e353774ec602bec">kMinModeFactorOcropus</a> = 32</td></tr>
<tr class="memitem:a8cc0a8bda114c498330f8b2a23e67453"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00888.html#a8cc0a8bda114c498330f8b2a23e67453">kMinModeFactor</a> = 12</td></tr>
</table>
<hr/><h2>Macro Definition Documentation</h2>
<a class="anchor" id="a996f7be338ccb40d1a2a5abc1ad61759"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ABS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)&lt;0 ? (-(x)) : (x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00074">74</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a23ca4a264fba12e846d074b48bc37fc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DELTAHEIGHT&#160;&#160;&#160;5.0   /* Small amount <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> diff */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00067">67</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a636b5d65e6e76c9ed9c87d72e5b743da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DESCENDER_FRACTION&#160;&#160;&#160;0.5   /*descender/x-height */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00058">58</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a77366c1bd428629dc898e188bfd182a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXTERN</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00036">36</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7cfa5dee1fc7046cb35913d0d4f7a989"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GOODHEIGHT&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00068">68</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a63c525ba0f53cbbfe37cb7900e8df67d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HEIGHTBUCKETS&#160;&#160;&#160;200   /* Num <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> buckets */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00066">66</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a058e03b643cfba9a6b7899b9a91f9bcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXBADRUN&#160;&#160;&#160;2     /*max non best for failed */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00065">65</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ade1da022379102bc94d127f9c6358fe7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXHEIGHT&#160;&#160;&#160;300   /*max blob height */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00063">63</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af1babcc3994c55728d10e3de8a5f01c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXHEIGHTVARIANCE&#160;&#160;&#160;0.15  /*accepted variation in x-height */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00062">62</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1f977147000cd8a40ccfacafea826a8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXLOOPS&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00069">69</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2789b0522b4b2520ddc257d0a2ba472a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXOVERLAP&#160;&#160;&#160;0.1   /*max 10% missed overlap */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00064">64</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a43c12716e71c3b49f1907bd935376e43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXPARTS&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00071">71</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="adafb7e3ebb2a384efa0f5a1b40476a63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_ASC_FRACTION&#160;&#160;&#160;0.20  /*min size <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> ascenders */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00059">59</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab10df8c6f46b62530ddf3d39eada5cbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_DESC_FRACTION&#160;&#160;&#160;0.25  /*min size <a class="el" href="a00639.html#a66c7f757ef35e33a52ac2efe3f4e8247">of</a> descenders */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00060">60</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae325902750f29296b4fb7ae22ecbb3dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MINASCRISE&#160;&#160;&#160;2.0   /*min ascender/desc step */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00061">61</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6d5223c09db5f2c89d2d0cb1990cae25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODENUM&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00070">70</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a28ed3351013f0697aa3189e7cfb669fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPLINESIZE&#160;&#160;&#160;23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00072">72</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a740201e7bcfb78e2fe8a8674096d13fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TURNLIMIT&#160;&#160;&#160;1     /*min size for turning point */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00056">56</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a69d365e20fc65dc84fb7426c5d20fdaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X_HEIGHT_FRACTION&#160;&#160;&#160;0.7   /*x-height/caps height */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00057">57</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a686c8b34dade68c0dd9e68ec7206739a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int choose_partition </td>
          <td>(</td>
          <td class="paramtype">register float&#160;</td>
          <td class="paramname"><em>diff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>partdiffs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lastpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>drift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>lastdelta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>partcount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00963">963</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> partition;        <span class="comment">/*partition no */</span></div>
<div class="line">  <span class="keywordtype">int</span> bestpart;                  <span class="comment">/*best new partition */</span></div>
<div class="line">  <span class="keywordtype">float</span> bestdelta;               <span class="comment">/*best gap from a part */</span></div>
<div class="line">  <span class="keywordtype">float</span> delta;                   <span class="comment">/*diff from part */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (lastpart &lt; 0) {</div>
<div class="line">    partdiffs[0] = diff;</div>
<div class="line">    lastpart = 0;                <span class="comment">/*first point */</span></div>
<div class="line">    *drift = 0.0f;</div>
<div class="line">    *lastdelta = 0.0f;</div>
<div class="line">  }</div>
<div class="line">                                 <span class="comment">/*adjusted diff from part */</span></div>
<div class="line">  delta = diff - partdiffs[lastpart] - *drift;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Diff=%.2f, Delta=%.3f, Drift=%.3f, &quot;</span>, diff, delta, *drift);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (delta) &gt; jumplimit / 2) {</div>
<div class="line">                                 <span class="comment">/*delta on part 0 */</span></div>
<div class="line">    bestdelta = diff - partdiffs[0] - *drift;</div>
<div class="line">    bestpart = 0;                <span class="comment">/*0 best so far */</span></div>
<div class="line">    <span class="keywordflow">for</span> (partition = 1; partition &lt; *partcount; partition++) {</div>
<div class="line">      delta = diff - partdiffs[partition] - *drift;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (delta) &lt; <a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (bestdelta)) {</div>
<div class="line">        bestdelta = delta;</div>
<div class="line">        bestpart = partition;    <span class="comment">/*part with nearest jump */</span></div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    delta = bestdelta;</div>
<div class="line">                                 <span class="comment">/*too far away */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (bestdelta) &gt; jumplimit</div>
<div class="line">    &amp;&amp; *partcount &lt; <a class="code" href="a00888.html#a43c12716e71c3b49f1907bd935376e43">MAXPARTS</a>) {  <span class="comment">/*and spare part left */</span></div>
<div class="line">      bestpart = (*partcount)++; <span class="comment">/*best was new one */</span></div>
<div class="line">                                 <span class="comment">/*start new one */</span></div>
<div class="line">      partdiffs[bestpart] = diff - *drift;</div>
<div class="line">      delta = 0.0f;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    bestpart = lastpart;         <span class="comment">/*best was last one */</span></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (bestpart == lastpart</div>
<div class="line">    &amp;&amp; (<a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (delta - *lastdelta) &lt; jumplimit / 2</div>
<div class="line">    || <a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (delta) &lt; jumplimit / 2))</div>
<div class="line">                                 <span class="comment">/*smooth the drift */</span></div>
<div class="line">    *drift = (3 * *drift + delta) / 3;</div>
<div class="line">  *lastdelta = delta;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;P=%d\n&quot;</span>, bestpart);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> bestpart;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a010670c118cee8bc7b8c74125084ac30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void find_lesser_parts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00374.html">TO_ROW</a> *&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>partids</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partsizes</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bestpart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01377">1377</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*index of blob */</span></div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> partition;        <span class="comment">/*current partition */</span></div>
<div class="line">  <span class="keywordtype">int</span> xcentre;                   <span class="comment">/*centre of blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> poscount;                  <span class="comment">/*count of best up step */</span></div>
<div class="line">  <span class="keywordtype">int</span> negcount;                  <span class="comment">/*count of best down step */</span></div>
<div class="line">  <span class="keywordtype">float</span> partsteps[<a class="code" href="a00888.html#a43c12716e71c3b49f1907bd935376e43">MAXPARTS</a>];     <span class="comment">/*average step to part */</span></div>
<div class="line">  <span class="keywordtype">float</span> bestpos;                 <span class="comment">/*best up step */</span></div>
<div class="line">  <span class="keywordtype">float</span> bestneg;                 <span class="comment">/*best down step */</span></div>
<div class="line">  <span class="keywordtype">int</span> runlength;                 <span class="comment">/*length of bad run */</span></div>
<div class="line">  <span class="keywordtype">int</span> biggestrun;                <span class="comment">/*biggest bad run */</span></div>
<div class="line"></div>
<div class="line">  biggestrun = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (partition = 0; partition &lt; partcount; partition++)</div>
<div class="line">    partsteps[partition] = 0.0;  <span class="comment">/*zero accumulators */</span></div>
<div class="line">  <span class="keywordflow">for</span> (runlength = 0, blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">    xcentre = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ()</div>
<div class="line">      + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) &gt;&gt; 1;</div>
<div class="line">                                 <span class="comment">/*in other parts */</span></div>
<div class="line">    <span class="keywordflow">if</span> (partids[blobindex] != bestpart) {</div>
<div class="line">      runlength++;               <span class="comment">/*run of non bests */</span></div>
<div class="line">      <span class="keywordflow">if</span> (runlength &gt; biggestrun)</div>
<div class="line">        biggestrun = runlength;</div>
<div class="line">      partsteps[partids[blobindex]] += blobcoords[blobindex].<a class="code" href="a00347.html#a4451d237f1cd18c4982d63fe36a11fc3">bottom</a> ()</div>
<div class="line">        - row-&gt;<a class="code" href="a00374.html#a611050c4612df0ccd0f2d64ca0005b9b">baseline</a>.<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcentre);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      runlength = 0;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (biggestrun &gt; <a class="code" href="a00888.html#a058e03b643cfba9a6b7899b9a91f9bcb">MAXBADRUN</a>)</div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = -1.0f;        <span class="comment">/*failed */</span></div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = 1.0f;         <span class="comment">/*success */</span></div>
<div class="line">  poscount = negcount = 0;</div>
<div class="line">  bestpos = bestneg = 0.0;       <span class="comment">/*no step yet */</span></div>
<div class="line">  <span class="keywordflow">for</span> (partition = 0; partition &lt; partcount; partition++) {</div>
<div class="line">    <span class="keywordflow">if</span> (partition != bestpart) {</div>
<div class="line"></div>
<div class="line">        <span class="comment">//by jetsoft divide by zero possible</span></div>
<div class="line">                <span class="keywordflow">if</span> (partsizes[partition]==0)</div>
<div class="line">                partsteps[partition]=0;</div>
<div class="line">       <span class="keywordflow">else</span></div>
<div class="line">                partsteps[partition] /= partsizes[partition];</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (partsteps[partition] &gt;= <a class="code" href="a00888.html#ae325902750f29296b4fb7ae22ecbb3dd">MINASCRISE</a></div>
<div class="line">      &amp;&amp; partsizes[partition] &gt; poscount) {</div>
<div class="line">                                 <span class="comment">/*ascender rise */</span></div>
<div class="line">        bestpos = partsteps[partition];</div>
<div class="line">                                 <span class="comment">/*2nd most popular */</span></div>
<div class="line">        poscount = partsizes[partition];</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (partsteps[partition] &lt;= -<a class="code" href="a00888.html#ae325902750f29296b4fb7ae22ecbb3dd">MINASCRISE</a></div>
<div class="line">      &amp;&amp; partsizes[partition] &gt; negcount) {</div>
<div class="line">                                 <span class="comment">/*ascender rise */</span></div>
<div class="line">        bestneg = partsteps[partition];</div>
<div class="line">                                 <span class="comment">/*2nd most popular */</span></div>
<div class="line">        negcount = partsizes[partition];</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">                                 <span class="comment">/*average x-height */</span></div>
<div class="line">  partsteps[bestpart] /= blobcount;</div>
<div class="line">  row-&gt;<a class="code" href="a00374.html#acc50308b9a0cd5c73184de33971c55a8">descdrop</a> = bestneg;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f17754e45de03ca3f0e2be965f8d4f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void find_top_modes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00318.html">STATS</a> *&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>statnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>modelist</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>modenum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01632">1632</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keywordtype">int</span> mode_count;</div>
<div class="line">  <span class="keywordtype">int</span> last_i = 0;</div>
<div class="line">  <span class="keywordtype">int</span> last_max = <a class="code" href="a00577.html#aac62d87844689a18b6f5339a89ed6e7f">MAX_INT32</a>;</div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="a00446.html#afc03cf3e39248c2e339fee4d31f5f750">mode</a>;</div>
<div class="line">  <span class="keywordtype">int</span> total_max = 0;</div>
<div class="line">  <span class="keywordtype">int</span> mode_factor = <a class="code" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> ?</div>
<div class="line">                    <a class="code" href="a00888.html#a4b62dc4268d026719e353774ec602bec">kMinModeFactorOcropus</a> : <a class="code" href="a00888.html#a8cc0a8bda114c498330f8b2a23e67453">kMinModeFactor</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (mode_count = 0; mode_count &lt; modenum; mode_count++) {</div>
<div class="line">    mode = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; statnum; i++) {</div>
<div class="line">      <span class="keywordflow">if</span> (stats-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (i) &gt; stats-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (mode)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((stats-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (i) &lt; last_max) ||</div>
<div class="line">        ((stats-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (i) == last_max) &amp;&amp; (i &gt; last_i))) {</div>
<div class="line">          mode = i;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    last_i = <a class="code" href="a00446.html#afc03cf3e39248c2e339fee4d31f5f750">mode</a>;</div>
<div class="line">    last_max = stats-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (last_i);</div>
<div class="line">    total_max += last_max;</div>
<div class="line">    <span class="keywordflow">if</span> (last_max &lt;= total_max / mode_factor)</div>
<div class="line">      mode = 0;</div>
<div class="line">    modelist[mode_count] = <a class="code" href="a00446.html#afc03cf3e39248c2e339fee4d31f5f750">mode</a>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8bbd79e9db94d47b2998e03850b18181"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_blob_coords </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00374.html">TO_ROW</a> *&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a>&#160;</td>
          <td class="paramname"><em>lineheight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a> *&#160;</td>
          <td class="paramname"><em>blobcoords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> &amp;&#160;</td>
          <td class="paramname"><em>holed_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>outcount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00447">447</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">                     {</div>
<div class="line">                                 <span class="comment">//blobs</span></div>
<div class="line">  BLOBNBOX_IT blob_it = row-&gt;<a class="code" href="a00374.html#a39cee94572e70d35179c27cdf21a3022">blob_list</a> ();</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*no along text line */</span></div>
<div class="line">  <span class="keywordtype">int</span> losscount;                 <span class="comment">//lost blobs</span></div>
<div class="line">  <span class="keywordtype">int</span> maxlosscount;              <span class="comment">//greatest lost blobs</span></div>
<div class="line">                                 <span class="comment">/*height stat collection */</span></div>
<div class="line">  <a class="code" href="a00318.html">STATS</a> heightstat (0, <a class="code" href="a00888.html#ade1da022379102bc94d127f9c6358fe7">MAXHEIGHT</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (blob_it.empty ())</div>
<div class="line">    <span class="keywordflow">return</span> 0;                    <span class="comment">//none</span></div>
<div class="line">  maxlosscount = 0;</div>
<div class="line">  losscount = 0;</div>
<div class="line">  blob_it.mark_cycle_pt ();</div>
<div class="line">  blobindex = 0;</div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">    blobcoords[blobindex] = <a class="code" href="a00473.html#a3728c3433d1e8f6a2178bb796aa21fad">box_next_pre_chopped</a> (&amp;blob_it);</div>
<div class="line">    <span class="keywordflow">if</span> (blobcoords[blobindex].height () &gt; lineheight * 0.25)</div>
<div class="line">      heightstat.add (blobcoords[blobindex].height (), 1);</div>
<div class="line">    <span class="keywordflow">if</span> (blobindex == 0</div>
<div class="line">      || blobcoords[blobindex].height () &gt; lineheight * 0.25</div>
<div class="line">    || blob_it.cycled_list ()) {</div>
<div class="line">      blobindex++;               <span class="comment">/*no of merged blobs */</span></div>
<div class="line">      losscount = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (blobcoords[blobindex].height ()</div>
<div class="line">        &lt; blobcoords[blobindex].<a class="code" href="a00347.html#af95494a2ccacc70cc2b83820b2948619">width</a> () * <a class="code" href="a00888.html#a1c777e24551f3606e42efe3bdb71d56c">oldbl_dot_error_size</a></div>
<div class="line">        &amp;&amp; blobcoords[blobindex].<a class="code" href="a00347.html#af95494a2ccacc70cc2b83820b2948619">width</a> ()</div>
<div class="line">      &lt; blobcoords[blobindex].<a class="code" href="a00347.html#a8379d4bbc72bdbb1f069fc14790e632d">height</a> () * <a class="code" href="a00888.html#a1c777e24551f3606e42efe3bdb71d56c">oldbl_dot_error_size</a>) {</div>
<div class="line">                                 <span class="comment">//counts as dot</span></div>
<div class="line">        blobindex++;</div>
<div class="line">        losscount = 0;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> {</div>
<div class="line">        losscount++;             <span class="comment">//lost it</span></div>
<div class="line">        <span class="keywordflow">if</span> (losscount &gt; maxlosscount)</div>
<div class="line">                                 <span class="comment">//remember max</span></div>
<div class="line">            maxlosscount = losscount;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">while</span> (!blob_it.cycled_list ());</div>
<div class="line"></div>
<div class="line">  holed_line = maxlosscount &gt; <a class="code" href="a00888.html#a74b5ea2ca513022fc65ac2d68d1179fd">oldbl_holed_losscount</a>;</div>
<div class="line">  outcount = blobindex;          <span class="comment">/*total blobs */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (heightstat.get_total () &gt; 1)</div>
<div class="line">                                 <span class="comment">/*guess x-height */</span></div>
<div class="line">    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) heightstat.ile (0.25);</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> blobcoords[0].<a class="code" href="a00347.html#a8379d4bbc72bdbb1f069fc14790e632d">height</a> ();</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8be53753ccb635852471514dcbf65b9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_ydiffs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ydiffs</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00912">912</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*current blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> xcentre;                   <span class="comment">/*xcoord */</span></div>
<div class="line">  <span class="keywordtype">int</span> lastx;                     <span class="comment">/*last xcentre */</span></div>
<div class="line">  <span class="keywordtype">float</span> diffsum;                 <span class="comment">/*sum of diffs */</span></div>
<div class="line">  <span class="keywordtype">float</span> diff;                    <span class="comment">/*current difference */</span></div>
<div class="line">  <span class="keywordtype">float</span> drift;                   <span class="comment">/*sum of spline steps */</span></div>
<div class="line">  <span class="keywordtype">float</span> bestsum;                 <span class="comment">/*smallest diffsum */</span></div>
<div class="line">  <span class="keywordtype">int</span> bestindex;                 <span class="comment">/*index of bestsum */</span></div>
<div class="line"></div>
<div class="line">  diffsum = 0.0f;</div>
<div class="line">  bestindex = 0;</div>
<div class="line">  bestsum = (float) <a class="code" href="a00577.html#aac62d87844689a18b6f5339a89ed6e7f">MAX_INT32</a>;</div>
<div class="line">  drift = 0.0f;</div>
<div class="line">  lastx = blobcoords[0].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ();</div>
<div class="line">                                 <span class="comment">/*do each blob in row */</span></div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">                                 <span class="comment">/*centre of blob */</span></div>
<div class="line">    xcentre = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) &gt;&gt; 1;</div>
<div class="line">                                 <span class="comment">//step functions in spline</span></div>
<div class="line">    drift += spline-&gt;<a class="code" href="a00276.html#aaebd602e34d8b7f4e7b73884f1701a75">step</a> (lastx, xcentre);</div>
<div class="line">    lastx = xcentre;</div>
<div class="line">    diff = blobcoords[blobindex].<a class="code" href="a00347.html#a4451d237f1cd18c4982d63fe36a11fc3">bottom</a> ();</div>
<div class="line">    diff -= spline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcentre);</div>
<div class="line">    diff += drift;</div>
<div class="line">    ydiffs[blobindex] = diff;    <span class="comment">/*store difference */</span></div>
<div class="line">    <span class="keywordflow">if</span> (blobindex &gt; 2)</div>
<div class="line">                                 <span class="comment">/*remove old one */</span></div>
<div class="line">      diffsum -= <a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (ydiffs[blobindex - 3]);</div>
<div class="line">    diffsum += <a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (diff);       <span class="comment">/*add new one */</span></div>
<div class="line">    <span class="keywordflow">if</span> (blobindex &gt;= 2 &amp;&amp; diffsum &lt; bestsum) {</div>
<div class="line">      bestsum = diffsum;         <span class="comment">/*find min sum */</span></div>
<div class="line">      bestindex = blobindex - 1; <span class="comment">/*middle of set */</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> bestindex;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a64dfef97655fe4ff4565ed05d7d0f53a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert_spline_point </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xstarts</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coord1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coord2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>segments</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01353">1353</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keywordtype">int</span> index;                     <span class="comment">//for shuffling</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (index = segments; index &gt; segment; index--)</div>
<div class="line">    xstarts[index + 1] = xstarts[index];</div>
<div class="line">  segments++;</div>
<div class="line">  xstarts[segment] = coord1;</div>
<div class="line">  xstarts[segment + 1] = coord2;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8183cffcfbc4d5ea44607619f14b44f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_first_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ycoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00517">517</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keywordtype">int</span> leftedge;                  <span class="comment">/*left edge of line */</span></div>
<div class="line">  <span class="keywordtype">int</span> rightedge;                 <span class="comment">/*right edge of line */</span></div>
<div class="line">  <span class="keywordtype">int</span> blobindex;                 <span class="comment">/*current blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> segment;                   <span class="comment">/*current segment */</span></div>
<div class="line">  <span class="keywordtype">float</span> prevy, thisy, nexty;     <span class="comment">/*3 y coords */</span></div>
<div class="line">  <span class="keywordtype">float</span> y1, y2, y3;              <span class="comment">/*3 smooth blobs */</span></div>
<div class="line">  <span class="keywordtype">float</span> maxmax, minmin;          <span class="comment">/*absolute limits */</span></div>
<div class="line">  <span class="keywordtype">int</span> x2 = 0;                    <span class="comment">/*right edge of old y3 */</span></div>
<div class="line">  <span class="keywordtype">int</span> ycount;                    <span class="comment">/*no of ycoords in use */</span></div>
<div class="line">  <span class="keywordtype">float</span> yturns[<a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a>];      <span class="comment">/*y coords of turn pts */</span></div>
<div class="line">  <span class="keywordtype">int</span> xturns[<a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a>];        <span class="comment">/*xcoords of turn pts */</span></div>
<div class="line">  <span class="keywordtype">int</span> xstarts[<a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> + 1];</div>
<div class="line">  <span class="keywordtype">int</span> segments;                  <span class="comment">//no of segments</span></div>
<div class="line">  <a class="code" href="a00183.html" title="integer coordinate">ICOORD</a> shift;                  <span class="comment">//shift of spline</span></div>
<div class="line"></div>
<div class="line">  prevy = 0;</div>
<div class="line">                                 <span class="comment">/*left edge of row */</span></div>
<div class="line">  leftedge = blobcoords[0].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ();</div>
<div class="line">                                 <span class="comment">/*right edge of line */</span></div>
<div class="line">  rightedge = blobcoords[blobcount - 1].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ();</div>
<div class="line">  <span class="keywordflow">if</span> (spline == <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>             <span class="comment">/*no given spline */</span></div>
<div class="line">    || spline-&gt;segments &lt; 3      <span class="comment">/*or trivial */</span></div>
<div class="line">                                 <span class="comment">/*or too non-overlap */</span></div>
<div class="line">    || spline-&gt;xcoords[1] &gt; leftedge + <a class="code" href="a00888.html#a2789b0522b4b2520ddc257d0a2ba472a">MAXOVERLAP</a> * (rightedge - leftedge)</div>
<div class="line">    || spline-&gt;xcoords[spline-&gt;segments - 1] &lt; rightedge</div>
<div class="line">  - <a class="code" href="a00888.html#a2789b0522b4b2520ddc257d0a2ba472a">MAXOVERLAP</a> * (rightedge - leftedge)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a26cc69b976618e872211e3974a7df35f">textord_oldbl_paradef</a>)</div>
<div class="line">      <span class="keywordflow">return</span>;                    <span class="comment">//use default</span></div>
<div class="line">    xstarts[0] = blobcoords[0].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () - 1;</div>
<div class="line">    <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">      xcoords[blobindex] = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ()</div>
<div class="line">        + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) / 2;</div>
<div class="line">      ycoords[blobindex] = blobcoords[blobindex].<a class="code" href="a00347.html#a4451d237f1cd18c4982d63fe36a11fc3">bottom</a> ();</div>
<div class="line">    }</div>
<div class="line">    xstarts[1] = blobcoords[blobcount - 1].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () + 1;</div>
<div class="line">    segments = 1;                <span class="comment">/*no of segments */</span></div>
<div class="line"></div>
<div class="line">                                 <span class="comment">/*linear */</span></div>
<div class="line">    *baseline = <a class="code" href="a00276.html">QSPLINE</a> (xstarts, segments, xcoords, ycoords, blobcount, 1);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (blobcount &gt;= 3) {</div>
<div class="line">      y1 = y2 = y3 = 0.0f;</div>
<div class="line">      ycount = 0;</div>
<div class="line">      segment = 0;               <span class="comment">/*no of segments */</span></div>
<div class="line">      maxmax = minmin = 0.0f;</div>
<div class="line">      thisy = ycoords[0] - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcoords[0]);</div>
<div class="line">      nexty = ycoords[1] - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcoords[1]);</div>
<div class="line">      <span class="keywordflow">for</span> (blobindex = 2; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">        prevy = thisy;           <span class="comment">/*shift ycoords */</span></div>
<div class="line">        thisy = nexty;</div>
<div class="line">        nexty = ycoords[blobindex] - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcoords[blobindex]);</div>
<div class="line">                                 <span class="comment">/*middle of smooth y */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (thisy - prevy) &lt; jumplimit &amp;&amp; <a class="code" href="a00888.html#a996f7be338ccb40d1a2a5abc1ad61759">ABS</a> (thisy - nexty) &lt; jumplimit) {</div>
<div class="line">          y1 = y2;               <span class="comment">/*shift window */</span></div>
<div class="line">          y2 = y3;</div>
<div class="line">          y3 = thisy;            <span class="comment">/*middle point */</span></div>
<div class="line">          ycount++;</div>
<div class="line">                                 <span class="comment">/*local max */</span></div>
<div class="line">          <span class="keywordflow">if</span> (ycount &gt;= 3 &amp;&amp; ((y1 &lt; y2 &amp;&amp; y2 &gt;= y3)</div>
<div class="line">                                 <span class="comment">/*local min */</span></div>
<div class="line">          || (y1 &gt; y2 &amp;&amp; y2 &lt;= y3))) {</div>
<div class="line">            <span class="keywordflow">if</span> (segment &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 2) {</div>
<div class="line">                                 <span class="comment">/*turning pt */</span></div>
<div class="line">              xturns[segment] = x2;</div>
<div class="line">              yturns[segment] = y2;</div>
<div class="line">              segment++;         <span class="comment">/*no of spline segs */</span></div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (ycount == 1) {</div>
<div class="line">            maxmax = minmin = y3;<span class="comment">/*initialise limits */</span></div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (y3 &gt; maxmax)</div>
<div class="line">              maxmax = y3;       <span class="comment">/*biggest max */</span></div>
<div class="line">            <span class="keywordflow">if</span> (y3 &lt; minmin)</div>
<div class="line">              minmin = y3;       <span class="comment">/*smallest min */</span></div>
<div class="line">          }</div>
<div class="line">                                 <span class="comment">/*possible turning pt */</span></div>
<div class="line">          x2 = blobcoords[blobindex - 1].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ();</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      jumplimit *= 1.2;</div>
<div class="line">                                 <span class="comment">/*must be wavy */</span></div>
<div class="line">      <span class="keywordflow">if</span> (maxmax - minmin &gt; jumplimit) {</div>
<div class="line">        ycount = segment;        <span class="comment">/*no of segments */</span></div>
<div class="line">        <span class="keywordflow">for</span> (blobindex = 0, segment = 1; blobindex &lt; ycount;</div>
<div class="line">        blobindex++) {</div>
<div class="line">          <span class="keywordflow">if</span> (yturns[blobindex] &gt; minmin + jumplimit</div>
<div class="line">          || yturns[blobindex] &lt; maxmax - jumplimit) {</div>
<div class="line">                                 <span class="comment">/*significant peak */</span></div>
<div class="line">            <span class="keywordflow">if</span> (segment == 1</div>
<div class="line">              || yturns[blobindex] &gt; prevy + jumplimit</div>
<div class="line">            || yturns[blobindex] &lt; prevy - jumplimit) {</div>
<div class="line">                                 <span class="comment">/*different to previous */</span></div>
<div class="line">              xstarts[segment] = xturns[blobindex];</div>
<div class="line">              segment++;</div>
<div class="line">              prevy = yturns[blobindex];</div>
<div class="line">            }</div>
<div class="line">                                 <span class="comment">/*bigger max */</span></div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((prevy &gt; minmin + jumplimit &amp;&amp; yturns[blobindex] &gt; prevy)</div>
<div class="line">                                 <span class="comment">/*smaller min */</span></div>
<div class="line">            || (prevy &lt; maxmax - jumplimit &amp;&amp; yturns[blobindex] &lt; prevy)) {</div>
<div class="line">              xstarts[segment - 1] = xturns[blobindex];</div>
<div class="line">                                 <span class="comment">/*improved previous */</span></div>
<div class="line">              prevy = yturns[blobindex];</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        xstarts[segment] = blobcoords[blobcount - 1].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> () + 1;</div>
<div class="line">        segments = segment;      <span class="comment">/*no of segments */</span></div>
<div class="line">                                 <span class="comment">/*linear */</span></div>
<div class="line">        *baseline = <a class="code" href="a00276.html">QSPLINE</a> (xstarts, segments, xcoords, ycoords, blobcount, 1);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    *baseline = *spline;         <span class="comment">/*copy it */</span></div>
<div class="line">    shift = <a class="code" href="a00183.html" title="integer coordinate">ICOORD</a> (0, (<a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>) (blobcoords[0].bottom ()</div>
<div class="line">      - spline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (blobcoords[0].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ())));</div>
<div class="line">    baseline-&gt;<a class="code" href="a00276.html#a3d1808becf8a69d00747b444d9c76cf6">move</a> (shift);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57a9e3ff2547db03b8a316f2fb25f017"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_first_xheight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00374.html">TO_ROW</a> *&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineheight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>init_lineheight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01547">1547</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <a class="code" href="a00318.html">STATS</a> heightstat (0, <a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>);</div>
<div class="line">  <span class="keywordtype">int</span> lefts[<a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>];</div>
<div class="line">  <span class="keywordtype">int</span> rights[<a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>];</div>
<div class="line">  <span class="keywordtype">int</span> modelist[<a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>];</div>
<div class="line">  <span class="keywordtype">int</span> blobindex;</div>
<div class="line">  <span class="keywordtype">int</span> mode_count;                <span class="comment">//blobs to count in thr</span></div>
<div class="line">  <span class="keywordtype">int</span> sign_bit;</div>
<div class="line">  <span class="keywordtype">int</span> mode_threshold;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> kBaselineTouch = 2;  <span class="comment">// This really should change with resolution.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> kGoodStrength = 8;  <span class="comment">// Strength of baseline-touching heights.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">float</span> kMinHeight = 0.25;  <span class="comment">// Min fraction of lineheight to use.</span></div>
<div class="line"></div>
<div class="line">  sign_bit = row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> &gt; 0 ? 1 : -1;</div>
<div class="line"></div>
<div class="line">  memset(lefts, 0, <a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a> * <span class="keyword">sizeof</span>(lefts[0]));</div>
<div class="line">  memset(rights, 0, <a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a> * <span class="keyword">sizeof</span>(rights[0]));</div>
<div class="line">  mode_count = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">    <span class="keywordtype">int</span> xcenter = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () +</div>
<div class="line">        blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) / 2;</div>
<div class="line">    <span class="keywordtype">float</span> <a class="code" href="a00039.html#aedd2fbe577bea4938d80154db35c6685">base</a> = baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a>(xcenter);</div>
<div class="line">    <span class="keywordtype">float</span> bottomdiff = fabs(base - blobcoords[blobindex].bottom());</div>
<div class="line">    <span class="keywordtype">int</span> strength = <a class="code" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> &amp;&amp;</div>
<div class="line">                   bottomdiff &lt;= kBaselineTouch ? kGoodStrength : 1;</div>
<div class="line">    <span class="keywordtype">int</span> height = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(blobcoords[blobindex].<a class="code" href="a00347.html#adf92e9fdac1bdf11c10d1c4d1178791a">top</a> () - base + 0.5);</div>
<div class="line">    <span class="keywordflow">if</span> (blobcoords[blobindex].height () &gt; init_lineheight * kMinHeight) {</div>
<div class="line">      <span class="keywordflow">if</span> (height &gt; lineheight * <a class="code" href="a00888.html#a9af9cfbc0c19dbe46551c127ed70e6e4">oldbl_xhfract</a></div>
<div class="line">        &amp;&amp; height &gt; <a class="code" href="a00886.html#a995fba1cadc1bb12bd1861d2e1d4bf4a">textord_min_xheight</a>) {</div>
<div class="line">        heightstat.add (height, strength);</div>
<div class="line">        <span class="keywordflow">if</span> (height &lt; <a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>) {</div>
<div class="line">          <span class="keywordflow">if</span> (xcenter &gt; rights[height])</div>
<div class="line">            rights[height] = xcenter;</div>
<div class="line">          <span class="keywordflow">if</span> (xcenter &gt; 0 &amp;&amp; (lefts[height] == 0 || xcenter &lt; lefts[height]))</div>
<div class="line">            lefts[height] = xcenter;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      mode_count += strength;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  mode_threshold = (int) (blobcount * 0.1);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a1c777e24551f3606e42efe3bdb71d56c">oldbl_dot_error_size</a> &gt; 1 || <a class="code" href="a00888.html#a96a1495ef629e0595833f43d1e0d8edd">oldbl_xhfix</a>)</div>
<div class="line">    mode_threshold = (int) (mode_count * 0.1);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;blobcount=%d, mode_count=%d, mode_t=%d\n&quot;</span>,</div>
<div class="line">      blobcount, mode_count, mode_threshold);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="a00888.html#a2f17754e45de03ca3f0e2be965f8d4f4">find_top_modes</a>(&amp;heightstat, <a class="code" href="a00888.html#a63c525ba0f53cbbfe37cb7900e8df67d">HEIGHTBUCKETS</a>, modelist, <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">    <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; blobindex++)</div>
<div class="line">      <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;mode[%d]=%d &quot;</span>, blobindex, modelist[blobindex]);</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="a00888.html#a7cfd63f215d5f9d728d795ea43eaf7af">pick_x_height</a>(row, modelist, lefts, rights, &amp;heightstat, mode_threshold);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Output xheight=%g\n&quot;</span>, row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> &lt; 0 &amp;&amp; <a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;warning: Row Line height &lt; 0; %4.2f\n&quot;</span>, row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a>);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (sign_bit &lt; 0)</div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = -row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6640bd141affa5aec1d6d3ee0e724e66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_holed_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00660">660</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keywordtype">int</span> leftedge;                  <span class="comment">/*left edge of line */</span></div>
<div class="line">  <span class="keywordtype">int</span> rightedge;                 <span class="comment">/*right edge of line */</span></div>
<div class="line">  <span class="keywordtype">int</span> blobindex;                 <span class="comment">/*current blob */</span></div>
<div class="line">  <span class="keywordtype">float</span> x;                       <span class="comment">//centre of row</span></div>
<div class="line">  <a class="code" href="a00183.html" title="integer coordinate">ICOORD</a> shift;                  <span class="comment">//shift of spline</span></div>
<div class="line"></div>
<div class="line">  <a class="code" href="a00128.html">tesseract::DetLineFit</a> lms;  <span class="comment">// straight baseline</span></div>
<div class="line">  <a class="code" href="a00577.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a> xstarts[2];              <span class="comment">//straight line</span></div>
<div class="line">  <span class="keywordtype">double</span> coeffs[3];</div>
<div class="line">  <span class="keywordtype">float</span> c;                       <span class="comment">//line parameter</span></div>
<div class="line"></div>
<div class="line">                                 <span class="comment">/*left edge of row */</span></div>
<div class="line">  leftedge = blobcoords[0].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ();</div>
<div class="line">                                 <span class="comment">/*right edge of line */</span></div>
<div class="line">  rightedge = blobcoords[blobcount - 1].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a>();</div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">    lms.<a class="code" href="a00128.html#a4eba2b6e761080e5d1a48c9c797257b2">Add</a>(<a class="code" href="a00183.html" title="integer coordinate">ICOORD</a>((blobcoords[blobindex].left() +</div>
<div class="line">                    blobcoords[blobindex].right()) / 2,</div>
<div class="line">                   blobcoords[blobindex].bottom()));</div>
<div class="line">  }</div>
<div class="line">  lms.<a class="code" href="a00128.html#a58c6ff442c9ab172952eea607f83dca8">ConstrainedFit</a>(gradient, &amp;c);</div>
<div class="line">  xstarts[0] = leftedge;</div>
<div class="line">  xstarts[1] = rightedge;</div>
<div class="line">  coeffs[0] = 0;</div>
<div class="line">  coeffs[1] = gradient;</div>
<div class="line">  coeffs[2] = c;</div>
<div class="line">  *baseline = <a class="code" href="a00276.html">QSPLINE</a> (1, xstarts, coeffs);</div>
<div class="line">  <span class="keywordflow">if</span> (spline != <a class="code" href="a00577.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>             <span class="comment">/*no given spline */</span></div>
<div class="line">    &amp;&amp; spline-&gt;segments &gt;= 3     <span class="comment">/*or trivial */</span></div>
<div class="line">                                 <span class="comment">/*or too non-overlap */</span></div>
<div class="line">    &amp;&amp; spline-&gt;xcoords[1] &lt;= leftedge + <a class="code" href="a00888.html#a2789b0522b4b2520ddc257d0a2ba472a">MAXOVERLAP</a> * (rightedge - leftedge)</div>
<div class="line">    &amp;&amp; spline-&gt;xcoords[spline-&gt;segments - 1] &gt;= rightedge</div>
<div class="line">  - <a class="code" href="a00888.html#a2789b0522b4b2520ddc257d0a2ba472a">MAXOVERLAP</a> * (rightedge - leftedge)) {</div>
<div class="line">    *baseline = *spline;         <span class="comment">/*copy it */</span></div>
<div class="line">    x = (leftedge + rightedge) / 2.0;</div>
<div class="line">    shift = <a class="code" href="a00183.html" title="integer coordinate">ICOORD</a> (0, (<a class="code" href="a00577.html#a8d41499d38c24d39b221ab0c158fe5a8">inT16</a>) (gradient * x + c - spline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (x)));</div>
<div class="line">    baseline-&gt;<a class="code" href="a00276.html#a3d1808becf8a69d00747b444d9c76cf6">move</a> (shift);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0024caf13f4e7f27e9c6ed3161138def"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void merge_oldbl_parts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>partids</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partsizes</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>biggestpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00799">799</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> found_one;               <span class="comment">//found a bestpart blob</span></div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> close_one;               <span class="comment">//found was close enough</span></div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*no along text line */</span></div>
<div class="line">  <span class="keywordtype">int</span> prevpart;                  <span class="comment">//previous iteration</span></div>
<div class="line">  <span class="keywordtype">int</span> runlength;                 <span class="comment">//no in this part</span></div>
<div class="line">  <span class="keywordtype">float</span> diff;                    <span class="comment">/*difference from line */</span></div>
<div class="line">  <span class="keywordtype">int</span> startx;                    <span class="comment">/*index of start blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> test_blob;                 <span class="comment">//another index</span></div>
<div class="line">  <a class="code" href="a00150.html">FCOORD</a> coord;                  <span class="comment">//blob coordinate</span></div>
<div class="line">  <span class="keywordtype">float</span> m, c;                    <span class="comment">//fitted line</span></div>
<div class="line">  <a class="code" href="a00274.html">QLSQ</a> stats;                    <span class="comment">//line stuff</span></div>
<div class="line"></div>
<div class="line">  prevpart = biggestpart;</div>
<div class="line">  runlength = 0;</div>
<div class="line">  startx = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">    <span class="keywordflow">if</span> (partids[blobindex] != prevpart) {</div>
<div class="line">      <span class="comment">//                      tprintf(&quot;Partition change at (%d,%d) from %d to %d after run of %d\n&quot;,</span></div>
<div class="line">      <span class="comment">//                              blobcoords[blobindex].left(),blobcoords[blobindex].bottom(),</span></div>
<div class="line">      <span class="comment">//                              prevpart,partids[blobindex],runlength);</span></div>
<div class="line">      <span class="keywordflow">if</span> (prevpart != biggestpart &amp;&amp; runlength &gt; <a class="code" href="a00888.html#a058e03b643cfba9a6b7899b9a91f9bcb">MAXBADRUN</a>) {</div>
<div class="line">        stats.<a class="code" href="a00274.html#a9f6ee88370df57093e248a2918ab20b2">clear</a> ();</div>
<div class="line">        <span class="keywordflow">for</span> (test_blob = startx; test_blob &lt; blobindex; test_blob++) {</div>
<div class="line">          coord = <a class="code" href="a00150.html">FCOORD</a> ((blobcoords[test_blob].left ()</div>
<div class="line">            + blobcoords[test_blob].right ()) / 2.0,</div>
<div class="line">            blobcoords[test_blob].bottom ());</div>
<div class="line">          stats.<a class="code" href="a00274.html#adbbaa8f4d49392cc26b46fabc476cc88">add</a> (coord.<a class="code" href="a00150.html#a9edadbfc357c730f62fa3c92677b0d58">x</a> (), coord.<a class="code" href="a00150.html#a397f7ce997b246df18e7bd5a20cc422e">y</a> ());</div>
<div class="line">        }</div>
<div class="line">        stats.<a class="code" href="a00274.html#a847b2fa0f918e971a56e8db0ce8ed18f">fit</a> (1);</div>
<div class="line">        m = stats.<a class="code" href="a00274.html#ab8de83e0968609f28aa83854431e2593">get_b</a> ();</div>
<div class="line">        c = stats.<a class="code" href="a00274.html#aeeedb9b168cef907167e4530dd4bf68a">get_c</a> ();</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">          <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Fitted line y=%g x + %g\n&quot;</span>, m, c);</div>
<div class="line">        found_one = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">        close_one = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (test_blob = 1; !found_one</div>
<div class="line">          &amp;&amp; (startx - test_blob &gt;= 0</div>
<div class="line">        || blobindex + test_blob &lt;= blobcount); test_blob++) {</div>
<div class="line">          <span class="keywordflow">if</span> (startx - test_blob &gt;= 0</div>
<div class="line">          &amp;&amp; partids[startx - test_blob] == biggestpart) {</div>
<div class="line">            found_one = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">            coord = <a class="code" href="a00150.html">FCOORD</a> ((blobcoords[startx - test_blob].left ()</div>
<div class="line">              + blobcoords[startx -</div>
<div class="line">              test_blob].right ()) /</div>
<div class="line">              2.0,</div>
<div class="line">              blobcoords[startx -</div>
<div class="line">              test_blob].bottom ());</div>
<div class="line">            diff = m * coord.<a class="code" href="a00150.html#a9edadbfc357c730f62fa3c92677b0d58">x</a> () + c - coord.<a class="code" href="a00150.html#a397f7ce997b246df18e7bd5a20cc422e">y</a> ();</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">              <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a></div>
<div class="line">                (<span class="stringliteral">&quot;Diff of common blob to suspect part=%g at (%g,%g)\n&quot;</span>,</div>
<div class="line">                diff, coord.<a class="code" href="a00150.html#a9edadbfc357c730f62fa3c92677b0d58">x</a> (), coord.<a class="code" href="a00150.html#a397f7ce997b246df18e7bd5a20cc422e">y</a> ());</div>
<div class="line">            <span class="keywordflow">if</span> (diff &lt; jumplimit &amp;&amp; -diff &lt; jumplimit)</div>
<div class="line">              close_one = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (blobindex + test_blob &lt;= blobcount</div>
<div class="line">          &amp;&amp; partids[blobindex + test_blob - 1] == biggestpart) {</div>
<div class="line">            found_one = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">            coord =</div>
<div class="line">              <a class="code" href="a00150.html">FCOORD</a> ((blobcoords[blobindex + test_blob - 1].</div>
<div class="line">              left () + blobcoords[blobindex + test_blob -</div>
<div class="line">              1].right ()) / 2.0,</div>
<div class="line">              blobcoords[blobindex + test_blob -</div>
<div class="line">              1].bottom ());</div>
<div class="line">            diff = m * coord.<a class="code" href="a00150.html#a9edadbfc357c730f62fa3c92677b0d58">x</a> () + c - coord.<a class="code" href="a00150.html#a397f7ce997b246df18e7bd5a20cc422e">y</a> ();</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">              <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a></div>
<div class="line">                (<span class="stringliteral">&quot;Diff of common blob to suspect part=%g at (%g,%g)\n&quot;</span>,</div>
<div class="line">                diff, coord.<a class="code" href="a00150.html#a9edadbfc357c730f62fa3c92677b0d58">x</a> (), coord.<a class="code" href="a00150.html#a397f7ce997b246df18e7bd5a20cc422e">y</a> ());</div>
<div class="line">            <span class="keywordflow">if</span> (diff &lt; jumplimit &amp;&amp; -diff &lt; jumplimit)</div>
<div class="line">              close_one = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (close_one) {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">            <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a></div>
<div class="line">              (<span class="stringliteral">&quot;Merged %d blobs back into part %d from %d starting at (%d,%d)\n&quot;</span>,</div>
<div class="line">              runlength, biggestpart, prevpart,</div>
<div class="line">              blobcoords[startx].left (),</div>
<div class="line">              blobcoords[startx].bottom ());</div>
<div class="line">                                 <span class="comment">//switch sides</span></div>
<div class="line">          partsizes[prevpart] -= runlength;</div>
<div class="line">          <span class="keywordflow">for</span> (test_blob = startx; test_blob &lt; blobindex; test_blob++)</div>
<div class="line">            partids[test_blob] = biggestpart;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      prevpart = partids[blobindex];</div>
<div class="line">      runlength = 1;</div>
<div class="line">      startx = blobindex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      runlength++;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d9be1c4d4bb8e4df217ddd66862b8ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void old_first_xheight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00374.html">TO_ROW</a> *&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initialheight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01462">1462</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*current blob */</span></div>
<div class="line">                                 <span class="comment">/*height statistics */</span></div>
<div class="line">  <a class="code" href="a00318.html">STATS</a> heightstat (0, <a class="code" href="a00888.html#ade1da022379102bc94d127f9c6358fe7">MAXHEIGHT</a>);</div>
<div class="line">  <span class="keywordtype">int</span> height;                    <span class="comment">/*height of blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> xcentre;                   <span class="comment">/*centre of blob */</span></div>
<div class="line">  <span class="keywordtype">int</span> lineheight;                <span class="comment">/*approx xheight */</span></div>
<div class="line">  <span class="keywordtype">float</span> ascenders;               <span class="comment">/*ascender sum */</span></div>
<div class="line">  <span class="keywordtype">int</span> asccount;                  <span class="comment">/*no of ascenders */</span></div>
<div class="line">  <span class="keywordtype">float</span> xsum;                    <span class="comment">/*xheight sum */</span></div>
<div class="line">  <span class="keywordtype">int</span> xcount;                    <span class="comment">/*xheight count */</span></div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">float</span> diff;           <span class="comment">/*height difference */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (blobcount &gt; 1) {</div>
<div class="line">    <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">      xcentre = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ()</div>
<div class="line">        + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) / 2;</div>
<div class="line">                                 <span class="comment">/*height of blob */</span></div>
<div class="line">      height = (int) (blobcoords[blobindex].<a class="code" href="a00039.html#ac669bc877615327b853410a841f48f4b">top</a> () - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcentre) + 0.5);</div>
<div class="line">      <span class="keywordflow">if</span> (height &gt; initialheight * <a class="code" href="a00888.html#a9af9cfbc0c19dbe46551c127ed70e6e4">oldbl_xhfract</a></div>
<div class="line">        &amp;&amp; height &gt; <a class="code" href="a00886.html#a995fba1cadc1bb12bd1861d2e1d4bf4a">textord_min_xheight</a>)</div>
<div class="line">        heightstat.add (height, 1);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (heightstat.get_total () &gt; 3) {</div>
<div class="line">      lineheight = (int) heightstat.ile (0.25);</div>
<div class="line">      <span class="keywordflow">if</span> (lineheight &lt;= 0)</div>
<div class="line">        lineheight = (int) heightstat.ile (0.5);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      lineheight = initialheight;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    lineheight = (int) (blobcoords[0].<a class="code" href="a00039.html#ac669bc877615327b853410a841f48f4b">top</a> ()</div>
<div class="line">      - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> ((blobcoords[0].left ()</div>
<div class="line">      + blobcoords[0].right ()) / 2) +</div>
<div class="line">      0.5);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  xsum = 0.0f;</div>
<div class="line">  xcount = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (ascenders = 0.0<a class="code" href="a00428.html#a469169df397b589e709dc744f1346831">f</a>, asccount = 0, blobindex = 0; blobindex &lt; blobcount;</div>
<div class="line">  blobindex++) {</div>
<div class="line">    xcentre = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> ()</div>
<div class="line">      + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) / 2;</div>
<div class="line">    diff = blobcoords[blobindex].<a class="code" href="a00347.html#adf92e9fdac1bdf11c10d1c4d1178791a">top</a> () - baseline-&gt;<a class="code" href="a00276.html#ab9f77ca80057e3844e880a1bf003beca">y</a> (xcentre);</div>
<div class="line">                                 <span class="comment">/*is it ascender */</span></div>
<div class="line">    <span class="keywordflow">if</span> (diff &gt; lineheight + jumplimit) {</div>
<div class="line">      ascenders += diff;</div>
<div class="line">      asccount++;                <span class="comment">/*count ascenders */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diff &gt; lineheight - jumplimit) {</div>
<div class="line">      xsum += diff;              <span class="comment">/*mean xheight */</span></div>
<div class="line">      xcount++;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (xcount &gt; 0)</div>
<div class="line">    xsum /= xcount;              <span class="comment">/*average xheight */</span></div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    xsum = (float) lineheight;   <span class="comment">/*guess it */</span></div>
<div class="line">  row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> *= xsum;</div>
<div class="line">  <span class="keywordflow">if</span> (asccount &gt; 0)</div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#acf8bf7f0f335788e106955b8142f832a">ascrise</a> = ascenders / asccount - xsum;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#acf8bf7f0f335788e106955b8142f832a">ascrise</a> = 0.0f;         <span class="comment">/*had none */</span></div>
<div class="line">  <span class="keywordflow">if</span> (row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> == 0)</div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = -1.0f;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad2034679e53c7d16b8306b773c552a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int partition_coords </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>partids</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bestpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ycoords</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>*merge_partitions(partids,partcount,blobcount,bestpart) discards funny looking </p>

<p>Definition at line <a class="el" href="a00888_source.html#l01090">1090</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*no along text line */</span></div>
<div class="line">  <span class="keywordtype">int</span> pointcount;                <span class="comment">/*no of points */</span></div>
<div class="line"></div>
<div class="line">  pointcount = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = 0; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">    <span class="keywordflow">if</span> (partids[blobindex] == bestpart) {</div>
<div class="line">                                 <span class="comment">/*centre of blob */</span></div>
<div class="line">      xcoords[pointcount] = (blobcoords[blobindex].<a class="code" href="a00347.html#a724fabf566586b663577dfa944ffbc61">left</a> () + blobcoords[blobindex].<a class="code" href="a00347.html#a8703081c1a1c26db3a4dddaca1028e34">right</a> ()) &gt;&gt; 1;</div>
<div class="line">      ycoords[pointcount++] = blobcoords[blobindex].<a class="code" href="a00347.html#a4451d237f1cd18c4982d63fe36a11fc3">bottom</a> ();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> pointcount;             <span class="comment">/*no of points found */</span></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a75f15842c2f303b5343bdc22504098a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int partition_line </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numparts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>partids</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partsizes</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ydiffs</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l00718">718</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> blobindex;        <span class="comment">/*no along text line */</span></div>
<div class="line">  <span class="keywordtype">int</span> bestpart;                  <span class="comment">/*best new partition */</span></div>
<div class="line">  <span class="keywordtype">int</span> biggestpart;               <span class="comment">/*part with most members */</span></div>
<div class="line">  <span class="keywordtype">float</span> diff;                    <span class="comment">/*difference from line */</span></div>
<div class="line">  <span class="keywordtype">int</span> startx;                    <span class="comment">/*index of start blob */</span></div>
<div class="line">  <span class="keywordtype">float</span> partdiffs[<a class="code" href="a00888.html#a43c12716e71c3b49f1907bd935376e43">MAXPARTS</a>];     <span class="comment">/*step between parts */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (bestpart = 0; bestpart &lt; <a class="code" href="a00888.html#a43c12716e71c3b49f1907bd935376e43">MAXPARTS</a>; bestpart++)</div>
<div class="line">    partsizes[bestpart] = 0;     <span class="comment">/*zero them all */</span></div>
<div class="line"></div>
<div class="line">  startx = <a class="code" href="a00888.html#a8be53753ccb635852471514dcbf65b9f">get_ydiffs</a> (blobcoords, blobcount, spline, ydiffs);</div>
<div class="line">  *numparts = 1;                 <span class="comment">/*1 partition */</span></div>
<div class="line">  bestpart = -1;                 <span class="comment">/*first point */</span></div>
<div class="line">  <span class="keywordtype">float</span> drift = 0.0f;</div>
<div class="line">  <span class="keywordtype">float</span> last_delta = 0.0f;</div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = startx; blobindex &lt; blobcount; blobindex++) {</div>
<div class="line">  <span class="comment">/*do each blob in row */</span></div>
<div class="line">    diff = ydiffs[blobindex];    <span class="comment">/*diff from line */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">      <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;%d(%d,%d), &quot;</span>, blobindex,</div>
<div class="line">        blobcoords[blobindex].left (),</div>
<div class="line">        blobcoords[blobindex].bottom ());</div>
<div class="line">    }</div>
<div class="line">    bestpart = <a class="code" href="a00888.html#a686c8b34dade68c0dd9e68ec7206739a">choose_partition</a>(diff, partdiffs, bestpart, jumplimit,</div>
<div class="line">                                &amp;drift, &amp;last_delta, numparts);</div>
<div class="line">                                 <span class="comment">/*record partition */</span></div>
<div class="line">    partids[blobindex] = bestpart;</div>
<div class="line">    partsizes[bestpart]++;       <span class="comment">/*another in it */</span></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  bestpart = -1;                 <span class="comment">/*first point */</span></div>
<div class="line">  drift = 0.0f;</div>
<div class="line">  last_delta = 0.0f;</div>
<div class="line">  partsizes[0]--;                <span class="comment">/*doing 1st pt again */</span></div>
<div class="line">                                 <span class="comment">/*do each blob in row */</span></div>
<div class="line">  <span class="keywordflow">for</span> (blobindex = startx; blobindex &gt;= 0; blobindex--) {</div>
<div class="line">    diff = ydiffs[blobindex];    <span class="comment">/*diff from line */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>) {</div>
<div class="line">      <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;%d(%d,%d), &quot;</span>, blobindex,</div>
<div class="line">        blobcoords[blobindex].left (),</div>
<div class="line">        blobcoords[blobindex].bottom ());</div>
<div class="line">    }</div>
<div class="line">    bestpart = <a class="code" href="a00888.html#a686c8b34dade68c0dd9e68ec7206739a">choose_partition</a>(diff, partdiffs, bestpart, jumplimit,</div>
<div class="line">                                &amp;drift, &amp;last_delta, numparts);</div>
<div class="line">                                 <span class="comment">/*record partition */</span></div>
<div class="line">    partids[blobindex] = bestpart;</div>
<div class="line">    partsizes[bestpart]++;       <span class="comment">/*another in it */</span></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (biggestpart = 0, bestpart = 1; bestpart &lt; *numparts; bestpart++)</div>
<div class="line">    <span class="keywordflow">if</span> (partsizes[bestpart] &gt;= partsizes[biggestpart])</div>
<div class="line">      biggestpart = bestpart;    <span class="comment">/*new biggest */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#afbc9ce48742715129ec2659c3fcb5584">textord_oldbl_merge_parts</a>)</div>
<div class="line">    <a class="code" href="a00888.html#a0024caf13f4e7f27e9c6ed3161138def">merge_oldbl_parts</a>(blobcoords,</div>
<div class="line">                      blobcount,</div>
<div class="line">                      partids,</div>
<div class="line">                      partsizes,</div>
<div class="line">                      biggestpart,</div>
<div class="line">                      jumplimit);</div>
<div class="line">  <span class="keywordflow">return</span> biggestpart;            <span class="comment">/*biggest partition */</span></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7cfd63f215d5f9d728d795ea43eaf7af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pick_x_height </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00374.html">TO_ROW</a> *&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>modelist</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lefts</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rights</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00318.html">STATS</a> *&#160;</td>
          <td class="paramname"><em>heightstat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode_threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01672">1672</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">                                       {</div>
<div class="line">  <span class="keywordtype">int</span> x;</div>
<div class="line">  <span class="keywordtype">int</span> y;</div>
<div class="line">  <span class="keywordtype">int</span> z;</div>
<div class="line">  <span class="keywordtype">float</span> ratio;</div>
<div class="line">  <span class="keywordtype">int</span> found_one_bigger = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">  <span class="keywordtype">int</span> best_x_height = 0;</div>
<div class="line">  <span class="keywordtype">int</span> best_asc = 0;</div>
<div class="line">  <span class="keywordtype">int</span> num_in_best;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; x++) {</div>
<div class="line">    <span class="keywordflow">for</span> (y = 0; y &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; y++) {</div>
<div class="line">      <span class="comment">/* Check for two modes */</span></div>
<div class="line">      <span class="keywordflow">if</span> (modelist[x] &amp;&amp; modelist[y] &amp;&amp;</div>
<div class="line">          heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[x]) &gt; mode_threshold &amp;&amp;</div>
<div class="line">          (!<a class="code" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> ||</div>
<div class="line">           <a class="code" href="a00587.html#a74e75242132eaabbc1c512488a135926">MIN</a>(rights[modelist[x]], rights[modelist[y]]) &gt;</div>
<div class="line">           <a class="code" href="a00587.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(lefts[modelist[x]], lefts[modelist[y]]))) {</div>
<div class="line">        ratio = (float) modelist[y] / (<span class="keywordtype">float</span>) modelist[x];</div>
<div class="line">        <span class="keywordflow">if</span> (1.2 &lt; ratio &amp;&amp; ratio &lt; 1.8) {</div>
<div class="line">          <span class="comment">/* Two modes found */</span></div>
<div class="line">          best_x_height = modelist[x];</div>
<div class="line">          num_in_best = heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[x]);</div>
<div class="line"></div>
<div class="line">          <span class="comment">/* Try to get one higher */</span></div>
<div class="line">          <span class="keywordflow">do</span> {</div>
<div class="line">            found_one_bigger = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (z = 0; z &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; z++) {</div>
<div class="line">              <span class="keywordflow">if</span> (modelist[z] == best_x_height + 1 &amp;&amp;</div>
<div class="line">                  (!<a class="code" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> ||</div>
<div class="line">                    <a class="code" href="a00587.html#a74e75242132eaabbc1c512488a135926">MIN</a>(rights[modelist[x]], rights[modelist[y]]) &gt;</div>
<div class="line">                    <a class="code" href="a00587.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(lefts[modelist[x]], lefts[modelist[y]]))) {</div>
<div class="line">                ratio = (float) modelist[y] / (<span class="keywordtype">float</span>) modelist[z];</div>
<div class="line">                <span class="keywordflow">if</span> ((1.2 &lt; ratio &amp;&amp; ratio &lt; 1.8) &amp;&amp;</div>
<div class="line">                               <span class="comment">/* Should be half of best */</span></div>
<div class="line">                    heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[z]) &gt;</div>
<div class="line">                    num_in_best * 0.5) {</div>
<div class="line">                  best_x_height++;</div>
<div class="line">                  found_one_bigger = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">                  <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">while</span> (found_one_bigger);</div>
<div class="line"></div>
<div class="line">          <span class="comment">/* try to get a higher ascender */</span></div>
<div class="line"></div>
<div class="line">          best_asc = modelist[y];</div>
<div class="line">          num_in_best = heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[y]);</div>
<div class="line"></div>
<div class="line">          <span class="comment">/* Try to get one higher */</span></div>
<div class="line">          <span class="keywordflow">do</span> {</div>
<div class="line">            found_one_bigger = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (z = 0; z &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; z++) {</div>
<div class="line">              <span class="keywordflow">if</span> (modelist[z] &gt; best_asc &amp;&amp;</div>
<div class="line">                  (!<a class="code" href="a00888.html#ac37e1bbb003c40e45f6375d6451a1659">textord_ocropus_mode</a> ||</div>
<div class="line">                    <a class="code" href="a00587.html#a74e75242132eaabbc1c512488a135926">MIN</a>(rights[modelist[x]], rights[modelist[y]]) &gt;</div>
<div class="line">                    <a class="code" href="a00587.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(lefts[modelist[x]], lefts[modelist[y]]))) {</div>
<div class="line">                ratio = (float) modelist[z] / (<span class="keywordtype">float</span>) best_x_height;</div>
<div class="line">                <span class="keywordflow">if</span> ((1.2 &lt; ratio &amp;&amp; ratio &lt; 1.8) &amp;&amp;</div>
<div class="line">                               <span class="comment">/* Should be half of best */</span></div>
<div class="line">                    heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[z]) &gt;</div>
<div class="line">                    num_in_best * 0.5) {</div>
<div class="line">                  best_asc = modelist[z];</div>
<div class="line">                  found_one_bigger = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">                  <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">while</span> (found_one_bigger);</div>
<div class="line"></div>
<div class="line">          row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = (float) best_x_height;</div>
<div class="line">          row-&gt;<a class="code" href="a00374.html#acf8bf7f0f335788e106955b8142f832a">ascrise</a> = (float) best_asc - best_x_height;</div>
<div class="line">          <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  best_x_height = modelist[0];   <span class="comment">/* Single Mode found */</span></div>
<div class="line">  num_in_best = heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (best_x_height);</div>
<div class="line">  <span class="keywordflow">do</span> {</div>
<div class="line">                                 <span class="comment">/* Try to get one higher */</span></div>
<div class="line">    found_one_bigger = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (z = 1; z &lt; <a class="code" href="a00888.html#a6d5223c09db5f2c89d2d0cb1990cae25">MODENUM</a>; z++) {</div>
<div class="line">      <span class="comment">/* Should be half of best */</span></div>
<div class="line">      <span class="keywordflow">if</span> ((modelist[z] == best_x_height + 1) &amp;&amp;</div>
<div class="line">      (heightstat-&gt;<a class="code" href="a00318.html#a4a3a320660e2092eeaa605df70bea8ea">pile_count</a> (modelist[z]) &gt; num_in_best * 0.5)) {</div>
<div class="line">        best_x_height++;</div>
<div class="line">        found_one_bigger = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">while</span> (found_one_bigger);</div>
<div class="line"></div>
<div class="line">  row-&gt;<a class="code" href="a00374.html#acf8bf7f0f335788e106955b8142f832a">ascrise</a> = 0.0f;</div>
<div class="line">  row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = (float) best_x_height;</div>
<div class="line">  <span class="keywordflow">if</span> (row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> == 0)</div>
<div class="line">    row-&gt;<a class="code" href="a00374.html#a819d94a95b9aab802acbcba097c67b2b">xheight</a> = -1.0f;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a320b77e1f7ecd371bdab9b4a0c3e10db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int segment_spline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00347.html">TBOX</a>&#160;</td>
          <td class="paramname"><em>blobcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blobcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ycoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pointcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xstarts</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01121">1121</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> ptindex;          <span class="comment">/*no along text line */</span></div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> segment;          <span class="comment">/*partition no */</span></div>
<div class="line">  <span class="keywordtype">int</span> lastmin, lastmax;          <span class="comment">/*possible turn points */</span></div>
<div class="line">  <span class="keywordtype">int</span> turnpoints[<a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a>];    <span class="comment">/*good turning points */</span></div>
<div class="line">  <span class="keywordtype">int</span> turncount;                 <span class="comment">/*no of turning points */</span></div>
<div class="line">  <span class="keywordtype">int</span> max_x;                     <span class="comment">//max specified coord</span></div>
<div class="line"></div>
<div class="line">  xstarts[0] = xcoords[0] - 1;   <span class="comment">//leftmost defined pt</span></div>
<div class="line">  max_x = xcoords[pointcount - 1] + 1;</div>
<div class="line">  <span class="keywordflow">if</span> (degree &lt; 2)</div>
<div class="line">    pointcount = 0;</div>
<div class="line">  turncount = 0;                 <span class="comment">/*no turning points yet */</span></div>
<div class="line">  <span class="keywordflow">if</span> (pointcount &gt; 3) {</div>
<div class="line">    ptindex = 1;</div>
<div class="line">    lastmax = lastmin = 0;       <span class="comment">/*start with first one */</span></div>
<div class="line">    <span class="keywordflow">while</span> (ptindex &lt; pointcount - 1 &amp;&amp; turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1) {</div>
<div class="line">                                 <span class="comment">/*minimum */</span></div>
<div class="line">      <span class="keywordflow">if</span> (ycoords[ptindex - 1] &gt; ycoords[ptindex] &amp;&amp; ycoords[ptindex] &lt;= ycoords[ptindex + 1]) {</div>
<div class="line">        <span class="keywordflow">if</span> (ycoords[ptindex] &lt; ycoords[lastmax] - <a class="code" href="a00888.html#a740201e7bcfb78e2fe8a8674096d13fe">TURNLIMIT</a>) {</div>
<div class="line">          <span class="keywordflow">if</span> (turncount == 0 || turnpoints[turncount - 1] != lastmax)</div>
<div class="line">                                 <span class="comment">/*new max point */</span></div>
<div class="line">            turnpoints[turncount++] = lastmax;</div>
<div class="line">          lastmin = ptindex;     <span class="comment">/*latest minimum */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ycoords[ptindex] &lt; ycoords[lastmin]) {</div>
<div class="line">          lastmin = ptindex;     <span class="comment">/*lower minimum */</span></div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">                                 <span class="comment">/*maximum */</span></div>
<div class="line">      <span class="keywordflow">if</span> (ycoords[ptindex - 1] &lt; ycoords[ptindex] &amp;&amp; ycoords[ptindex] &gt;= ycoords[ptindex + 1]) {</div>
<div class="line">        <span class="keywordflow">if</span> (ycoords[ptindex] &gt; ycoords[lastmin] + <a class="code" href="a00888.html#a740201e7bcfb78e2fe8a8674096d13fe">TURNLIMIT</a>) {</div>
<div class="line">          <span class="keywordflow">if</span> (turncount == 0 || turnpoints[turncount - 1] != lastmin)</div>
<div class="line">                                 <span class="comment">/*new min point */</span></div>
<div class="line">            turnpoints[turncount++] = lastmin;</div>
<div class="line">          lastmax = ptindex;     <span class="comment">/*latest maximum */</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ycoords[ptindex] &gt; ycoords[lastmax]) {</div>
<div class="line">          lastmax = ptindex;     <span class="comment">/*higher maximum */</span></div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      ptindex++;</div>
<div class="line">    }</div>
<div class="line">                                 <span class="comment">/*possible global min */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ycoords[ptindex] &lt; ycoords[lastmax] - <a class="code" href="a00888.html#a740201e7bcfb78e2fe8a8674096d13fe">TURNLIMIT</a></div>
<div class="line">    &amp;&amp; (turncount == 0 || turnpoints[turncount - 1] != lastmax)) {</div>
<div class="line">      <span class="keywordflow">if</span> (turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1)</div>
<div class="line">                                 <span class="comment">/*2 more turns */</span></div>
<div class="line">        turnpoints[turncount++] = lastmax;</div>
<div class="line">      <span class="keywordflow">if</span> (turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1)</div>
<div class="line">        turnpoints[turncount++] = ptindex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ycoords[ptindex] &gt; ycoords[lastmin] + <a class="code" href="a00888.html#a740201e7bcfb78e2fe8a8674096d13fe">TURNLIMIT</a></div>
<div class="line">      <span class="comment">/*possible global max */</span></div>
<div class="line">    &amp;&amp; (turncount == 0 || turnpoints[turncount - 1] != lastmin)) {</div>
<div class="line">      <span class="keywordflow">if</span> (turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1)</div>
<div class="line">                                 <span class="comment">/*2 more turns */</span></div>
<div class="line">        turnpoints[turncount++] = lastmin;</div>
<div class="line">      <span class="keywordflow">if</span> (turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1)</div>
<div class="line">        turnpoints[turncount++] = ptindex;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (turncount &gt; 0 &amp;&amp; turnpoints[turncount - 1] == lastmin</div>
<div class="line">    &amp;&amp; turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1) {</div>
<div class="line">      <span class="keywordflow">if</span> (ycoords[ptindex] &gt; ycoords[lastmax])</div>
<div class="line">        turnpoints[turncount++] = ptindex;</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        turnpoints[turncount++] = lastmax;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (turncount &gt; 0 &amp;&amp; turnpoints[turncount - 1] == lastmax</div>
<div class="line">    &amp;&amp; turncount &lt; <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a> - 1) {</div>
<div class="line">      <span class="keywordflow">if</span> (ycoords[ptindex] &lt; ycoords[lastmin])</div>
<div class="line">        turnpoints[turncount++] = ptindex;</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        turnpoints[turncount++] = lastmin;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a> &amp;&amp; turncount &gt; 0)</div>
<div class="line">    <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;First turn is %d at (%d,%d)\n&quot;</span>,</div>
<div class="line">      turnpoints[0], xcoords[turnpoints[0]], ycoords[turnpoints[0]]);</div>
<div class="line">  <span class="keywordflow">for</span> (segment = 1; segment &lt; turncount; segment++) {</div>
<div class="line">                                 <span class="comment">/*centre y coord */</span></div>
<div class="line">    lastmax = (ycoords[turnpoints[segment - 1]] + ycoords[turnpoints[segment]]) / 2;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* fix alg so that it works with both rising and falling sections */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ycoords[turnpoints[segment - 1]] &lt; ycoords[turnpoints[segment]])</div>
<div class="line">                                 <span class="comment">/*find rising y centre */</span></div>
<div class="line">      <span class="keywordflow">for</span> (ptindex = turnpoints[segment - 1] + 1; ptindex &lt; turnpoints[segment] &amp;&amp; ycoords[ptindex + 1] &lt;= lastmax; ptindex++);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">                                 <span class="comment">/*find falling y centre */</span></div>
<div class="line">      <span class="keywordflow">for</span> (ptindex = turnpoints[segment - 1] + 1; ptindex &lt; turnpoints[segment] &amp;&amp; ycoords[ptindex + 1] &gt;= lastmax; ptindex++);</div>
<div class="line"></div>
<div class="line">                                 <span class="comment">/*centre x */</span></div>
<div class="line">    xstarts[segment] = (xcoords[ptindex - 1] + xcoords[ptindex]</div>
<div class="line">      + xcoords[turnpoints[segment - 1]]</div>
<div class="line">      + xcoords[turnpoints[segment]] + 2) / 4;</div>
<div class="line">    <span class="comment">/*halfway between turns */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a49b3afd2bc9858de5ba264e9e0ce74c7">textord_oldbl_debug</a>)</div>
<div class="line">      <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Turn %d is %d at (%d,%d), mid pt is %d@%d, final @%d\n&quot;</span>,</div>
<div class="line">        segment, turnpoints[segment],</div>
<div class="line">        xcoords[turnpoints[segment]], ycoords[turnpoints[segment]],</div>
<div class="line">        ptindex - 1, xcoords[ptindex - 1], xstarts[segment]);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  xstarts[segment] = max_x;</div>
<div class="line">  <span class="keywordflow">return</span> segment;                <span class="comment">/*no of splines */</span></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ebf232cd4ed4b8feb53a47b8248903f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> split_stepped_spline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00276.html">QSPLINE</a> *&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>jumplimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xcoords</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xstarts</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>segments</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01246">1246</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>
<div class="fragment"><div class="line">  {</div>
<div class="line">  <a class="code" href="a00577.html#a7712a7e28433d0ade59219a129549b6f">BOOL8</a> doneany;                 <span class="comment">//return value</span></div>
<div class="line">  <span class="keyword">register</span> <span class="keywordtype">int</span> segment;          <span class="comment">/*partition no */</span></div>
<div class="line">  <span class="keywordtype">int</span> startindex, centreindex, endindex;</div>
<div class="line">  <span class="keywordtype">float</span> leftcoord, rightcoord;</div>
<div class="line">  <span class="keywordtype">int</span> leftindex, rightindex;</div>
<div class="line">  <span class="keywordtype">float</span> step;                    <span class="comment">//spline step</span></div>
<div class="line"></div>
<div class="line">  doneany = <a class="code" href="a00409.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line">  startindex = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (segment = 1; segment &lt; segments - 1; segment++) {</div>
<div class="line">    step = baseline-&gt;<a class="code" href="a00276.html#aaebd602e34d8b7f4e7b73884f1701a75">step</a> ((xstarts[segment - 1] + xstarts[segment]) / 2.0,</div>
<div class="line">      (xstarts[segment] + xstarts[segment + 1]) / 2.0);</div>
<div class="line">    <span class="keywordflow">if</span> (step &lt; 0)</div>
<div class="line">      step = -step;</div>
<div class="line">    <span class="keywordflow">if</span> (step &gt; jumplimit) {</div>
<div class="line">      <span class="keywordflow">while</span> (xcoords[startindex] &lt; xstarts[segment - 1])</div>
<div class="line">        startindex++;</div>
<div class="line">      centreindex = startindex;</div>
<div class="line">      <span class="keywordflow">while</span> (xcoords[centreindex] &lt; xstarts[segment])</div>
<div class="line">        centreindex++;</div>
<div class="line">      endindex = centreindex;</div>
<div class="line">      <span class="keywordflow">while</span> (xcoords[endindex] &lt; xstarts[segment + 1])</div>
<div class="line">        endindex++;</div>
<div class="line">      <span class="keywordflow">if</span> (segments &gt;= <a class="code" href="a00888.html#a28ed3351013f0697aa3189e7cfb669fd">SPLINESIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a2522a1ae924de60d6448da45f785b4f8">textord_debug_baselines</a>)</div>
<div class="line">          <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Too many segments to resegment spline!!\n&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (endindex - startindex &gt;= <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a> * 3) {</div>
<div class="line">        <span class="keywordflow">while</span> (centreindex - startindex &lt;</div>
<div class="line">          <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a> * 3 / 2)</div>
<div class="line">          centreindex++;</div>
<div class="line">        <span class="keywordflow">while</span> (endindex - centreindex &lt;</div>
<div class="line">          <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a> * 3 / 2)</div>
<div class="line">          centreindex--;</div>
<div class="line">        leftindex = (startindex + startindex + centreindex) / 3;</div>
<div class="line">        rightindex = (centreindex + endindex + endindex) / 3;</div>
<div class="line">        leftcoord =</div>
<div class="line">          (xcoords[startindex] * 2 + xcoords[centreindex]) / 3.0;</div>
<div class="line">        rightcoord =</div>
<div class="line">          (xcoords[centreindex] + xcoords[endindex] * 2) / 3.0;</div>
<div class="line">        <span class="keywordflow">while</span> (xcoords[leftindex] &gt; leftcoord</div>
<div class="line">          &amp;&amp; leftindex - startindex &gt; <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a>)</div>
<div class="line">          leftindex--;</div>
<div class="line">        <span class="keywordflow">while</span> (xcoords[leftindex] &lt; leftcoord</div>
<div class="line">          &amp;&amp; centreindex - leftindex &gt;</div>
<div class="line">          <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a> / 2)</div>
<div class="line">          leftindex++;</div>
<div class="line">        <span class="keywordflow">if</span> (xcoords[leftindex] - leftcoord &gt;</div>
<div class="line">          leftcoord - xcoords[leftindex - 1])</div>
<div class="line">          leftindex--;</div>
<div class="line">        <span class="keywordflow">while</span> (xcoords[rightindex] &gt; rightcoord</div>
<div class="line">          &amp;&amp; rightindex - centreindex &gt;</div>
<div class="line">          <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a> / 2)</div>
<div class="line">          rightindex--;</div>
<div class="line">        <span class="keywordflow">while</span> (xcoords[rightindex] &lt; rightcoord</div>
<div class="line">          &amp;&amp; endindex - rightindex &gt; <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a>)</div>
<div class="line">          rightindex++;</div>
<div class="line">        <span class="keywordflow">if</span> (xcoords[rightindex] - rightcoord &gt;</div>
<div class="line">          rightcoord - xcoords[rightindex - 1])</div>
<div class="line">          rightindex--;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a2522a1ae924de60d6448da45f785b4f8">textord_debug_baselines</a>)</div>
<div class="line">          <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a> (<span class="stringliteral">&quot;Splitting spline at %d with step %g at (%d,%d)\n&quot;</span>,</div>
<div class="line">            xstarts[segment],</div>
<div class="line">            baseline-&gt;</div>
<div class="line">            step ((xstarts[segment - 1] +</div>
<div class="line">            xstarts[segment]) / 2.0,</div>
<div class="line">            (xstarts[segment] +</div>
<div class="line">            xstarts[segment + 1]) / 2.0),</div>
<div class="line">            (xcoords[leftindex - 1] + xcoords[leftindex]) / 2,</div>
<div class="line">            (xcoords[rightindex - 1] + xcoords[rightindex]) / 2);</div>
<div class="line">        <a class="code" href="a00888.html#a64dfef97655fe4ff4565ed05d7d0f53a">insert_spline_point</a> (xstarts, segment,</div>
<div class="line">          (xcoords[leftindex - 1] +</div>
<div class="line">          xcoords[leftindex]) / 2,</div>
<div class="line">          (xcoords[rightindex - 1] +</div>
<div class="line">          xcoords[rightindex]) / 2, segments);</div>
<div class="line">        doneany = <a class="code" href="a00409.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00888.html#a2522a1ae924de60d6448da45f785b4f8">textord_debug_baselines</a>) {</div>
<div class="line">        <a class="code" href="a00607.html#a0c2bcd4462ec67ab0971b34a0f610f55">tprintf</a></div>
<div class="line">          (<span class="stringliteral">&quot;Resegmenting spline failed - insufficient pts (%d,%d,%d,%d)\n&quot;</span>,</div>
<div class="line">          startindex, centreindex, endindex,</div>
<div class="line">          (<a class="code" href="a00577.html#aba1f582fd0168f3ff9225d8c90fa9eb8">inT32</a>) <a class="code" href="a00886.html#aa3f1e0813b0d1a67ec8fb489e1d11034">textord_spline_medianwin</a>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//              else tprintf(&quot;Spline step at %d is %g\n&quot;,</span></div>
<div class="line">    <span class="comment">//                      xstarts[segment],</span></div>
<div class="line">    <span class="comment">//                      baseline-&gt;step((xstarts[segment-1]+xstarts[segment])/2.0,</span></div>
<div class="line">    <span class="comment">//                      (xstarts[segment]+xstarts[segment+1])/2.0));</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> doneany;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a8cc0a8bda114c498330f8b2a23e67453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int kMinModeFactor = 12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01629">1629</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4b62dc4268d026719e353774ec602bec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int kMinModeFactorOcropus = 32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="a00888_source.html#l01628">1628</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4ac15a4b1008410caf408f3e7d71617b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool oldbl_corrfix = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Improve correlation of heights" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00045">45</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1c777e24551f3606e42efe3bdb71d56c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double oldbl_dot_error_size = 1.26</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Max aspect ratio of a dot" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00052">52</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a74b5ea2ca513022fc65ac2d68d1179fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> int oldbl_holed_losscount = 10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Max lost before fallback line used" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00051">51</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a96a1495ef629e0595833f43d1e0d8edd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool oldbl_xhfix = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Fix bug in modes threshold for xheights" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00047">47</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9af9cfbc0c19dbe46551c127ed70e6e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double oldbl_xhfract = 0.4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Fraction of est allowed in calc" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00049">49</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2522a1ae924de60d6448da45f785b4f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_debug_baselines = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Debug baseline generation" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00041">41</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac37e1bbb003c40e45f6375d6451a1659"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_ocropus_mode = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Make baselines for ocropus" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00048">48</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a49b3afd2bc9858de5ba264e9e0ce74c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_oldbl_debug = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Debug old baseline generation" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00040">40</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa0ab27b57cde2ce0d3e4c7c269ae58f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> double textord_oldbl_jumplimit = 0.15</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"X fraction for new partition" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00054">54</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afbc9ce48742715129ec2659c3fcb5584"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_oldbl_merge_parts = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Merge suspect partitions" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00044">44</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a26cc69b976618e872211e3974a7df35f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_oldbl_paradef = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Use para default mechanism" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00042">42</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a65c44b7980901c6716d6af6b5457fb55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_oldbl_split_splines = <a class="el" href="a00777.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Split stepped splines" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00043">43</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a160e4b5a4517db072dd572847b673c9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00957.html#a77366c1bd428629dc898e188bfd182a3">EXTERN</a> bool textord_really_old_xheight = <a class="el" href="a00777.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Use original wiseowl xheight" </p>

<p>Definition at line <a class="el" href="a00888_source.html#l00039">39</a> of file <a class="el" href="a00888_source.html">oldbasel.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b8d1739202f65d59e58cdec119e32197.html">mnt</a></li><li class="navelem"><a class="el" href="dir_5b13d613d053bd10e358ecb54357a5d6.html">data</a></li><li class="navelem"><a class="el" href="dir_6e8f8c7261375e16fe20bf1b1c7c3b87.html">src</a></li><li class="navelem"><a class="el" href="dir_7829ead854c076361e4bcb285111c733.html">tesseract-ocr</a></li><li class="navelem"><a class="el" href="dir_ec091aa1959eb7fc14b0c00630e6a7b8.html">textord</a></li><li class="navelem"><a class="el" href="a00888.html">oldbasel.cpp</a></li>
    <li class="footer">Generated on Thu Nov 1 2012 20:19:56 for Tesseract by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1 </li>
  </ul>
</div>
</body>
</html>
